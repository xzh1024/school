(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cb849c2"],{a9bc:function(e,t,a){},bee2:function(e,t,a){"use strict";function l(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function n(e,t,a){return t&&l(e.prototype,t),a&&l(e,a),e}a.d(t,"a",(function(){return n}))},c268:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"label_manage"},[a("div",{staticClass:"label_search"},[a("el-input",{staticStyle:{width:"300px"},attrs:{size:"small",placeholder:"标签名称","suffix-icon":"el-icon-search"},model:{value:e.searchIpt,callback:function(t){e.searchIpt=t},expression:"searchIpt"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.searchFn}},[e._v("查询")]),a("el-button",{attrs:{size:"small"},on:{click:e.resetFn}},[e._v("重置")])],1),a("div",{staticClass:"add_label"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addLabelFn}},[e._v("新建标签")])],1),a("el-table",{ref:"multipleTable",staticClass:"xtable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.tableData,border:"",stripe:"","tooltip-effect":"dark",height:"450px"},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{fixed:"",type:"selection",align:"center",width:"55"}}),a("el-table-column",{attrs:{prop:"name",label:"标签名称",align:"center","min-width":"300"}}),a("el-table-column",{attrs:{prop:"customerCount",label:"客户数",align:"center",sortable:"custom","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.customerCount?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.toReplaceClick(t.row)}}},[e._v(" "+e._s(t.row.customerCount)+" ")]):a("span",[e._v(e._s(t.row.customerCount))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editClick(t.row,t.$index)}}},[e._v("编辑")]),a("el-button",{staticClass:"txt_danger",attrs:{type:"text",size:"small"},on:{click:function(a){return e.delClick(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"page_footer"},[a("div",[a("el-checkbox",{on:{change:function(t){return e.tableDataChange(e.tableData)}},model:{value:e.searchResult,callback:function(t){e.searchResult=t},expression:"searchResult"}},[e._v("全选当前查询结果")]),a("span",{staticStyle:{margin:"0px 6px",padding:"0px 6px","border-left":"1px solid #000","border-right":"1px solid #000"}},[e._v("已选中 "+e._s(e.selection.length)+" 条")]),a("span",[e._v("批量操作")]),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{plain:"",size:"small",type:"danger"},on:{click:e.allDeleteFn}},[e._v("删除")])],1),a("el-pagination",{attrs:{"current-page":e.pageInfo.page,"page-sizes":[10,20,30,40],"page-size":e.pageInfo.pageSize,layout:"total, prev, pager, next, jumper, sizes",total:e.pageInfo.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:e.labelTitle,"close-on-click-modal":!1,visible:e.labelVisible,width:"450px"},on:{"update:visible":function(t){e.labelVisible=t}}},[a("el-form",{ref:"labelForm",staticClass:"demo-ruleForm",attrs:{model:e.labelForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"标签名称",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"最多可输入10个字符"},model:{value:e.labelForm.name,callback:function(t){e.$set(e.labelForm,"name",t)},expression:"labelForm.name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.cancelClick("labelForm")}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.saveClick("labelForm")}}},[e._v("保存")]),"新建标签"==e.labelTitle?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitClick("labelForm")}}},[e._v("保存并新建")]):e._e()],1)],1)],1)},n=[],i=(a("159b"),a("b0c0"),a("d4ec")),s=a("bee2"),c=a("b775"),o=function(){function e(){Object(i["a"])(this,e)}return Object(s["a"])(e,[{key:"getLabelsInfo",value:function(e){return Object(c["b"])({baseURL:c["a"].accounts,url:"/companies/labels",method:"get",params:e})}},{key:"deleteLabels",value:function(e){return Object(c["b"])({baseURL:c["a"].accounts,url:"/companies/labels",method:"delete",data:e})}},{key:"insertLabels",value:function(e){return Object(c["b"])({baseURL:c["a"].accounts,url:"/companies/labels",method:"post",data:e})}},{key:"updateLabels",value:function(e){return Object(c["b"])({baseURL:c["a"].accounts,url:"/companies/labels/".concat(e.id),method:"post",data:e})}}]),e}(),r=new o,u={name:"label_manage_page",data:function(){return{tableData:[],multipleSelection:[],selection:[],searchIpt:"",order:"",pageInfo:{page:1,totalSize:100,pageSize:20},searchResult:!1,labelVisible:!1,labelTitle:"新建标签",labelForm:{name:""},rules:{name:[{required:!0,message:"请输入标签名称",trigger:"blur"},{max:10,message:"最多可输入10个字符",trigger:"blur"}]},editIndex:-1,searchAll:!1}},created:function(){sessionStorage.removeItem("customerQueryObj")},mounted:function(){this.initData()},methods:{initData:function(){var e=this,t={page:this.pageInfo.page,pageSize:this.pageInfo.pageSize,name:this.searchIpt};this.order&&("descending"==this.order?t.order="customerCount-desc":"ascending"==this.order&&(t.order="customerCount-asc")),r.getLabelsInfo(t).then((function(t){e.tableData=t.rows||[],e.pageInfo.totalSize=t.totalSize})).catch((function(e){console.log(e)}))},searchFn:function(){this.initData(),this.$refs.multipleTable.clearSelection(),this.searchResult=!1},sortChange:function(e){var t=e.order;this.order=t,this.initData()},resetFn:function(){this.searchIpt="",this.searchFn()},toReplaceClick:function(e){var t={path:"/customerQuery",query:{labelId:e.id}};this.$router.push(t)},editClick:function(e,t){this.labelTitle="编辑标签",this.editIndex=t,this.labelVisible=!0,this.labelForm=Object.assign({},e)},handleSelectionChange:function(e){this.multipleSelection=e,this.selection=e},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.pageInfo.page=1,this.initData()},handleCurrentChange:function(e){this.pageInfo.page=e,this.initData()},delClick:function(e,t){var a=this;this.searchAll=!1,this.$confirm("删除后已标记的客户将自动失去该标签，你确定要删除当前标签吗？").then((function(t){a.deleteFn(e,0)})).catch((function(e){}))},deleteFn:function(e,t){var a=this,l={};t?(l={searchAll:this.searchAll,cond:{name:this.searchIpt},ids:[]},e.forEach((function(e){l.ids.push(e.id)}))):l={searchAll:this.searchAll,cond:{name:this.searchIpt},ids:[e.id]},r.deleteLabels(l).then((function(e){a.$message({message:"删除成功",type:"success"}),a.searchFn()})).catch((function(e){console.log(e||"删除失败")}))},allDeleteFn:function(){var e=this;if(!this.selection.length)return this.$message({message:"你还没有选择数据",type:"warning"}),!1;this.$confirm("删除后已标记的客户将自动失去该标签，你确定要删除当前标签吗？").then((function(t){e.deleteFn(e.selection,1)})).catch((function(t){e.$message.error(t)}))},tableDataChange:function(e){this.toggleSelection(e)},toggleSelection:function(e){var t=this;e?(this.searchAll=!0,e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)}))):(this.searchAll=!1,this.$refs.multipleTable.clearSelection())},addLabelFn:function(){this.labelTitle="新建标签",this.labelVisible=!0,this.labelForm={}},cancelClick:function(e){this.labelVisible=!1},saveClick:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;if("新建标签"==t.labelTitle)r.insertLabels(t.labelForm).then((function(a){t.$message({message:"新建标签成功",type:"success"}),t.initData(),t.labelVisible=!1,t.$refs[e].resetFields()})).catch((function(e){console.log(e)}));else{t.labelForm.id,t.labelForm.name;r.updateLabels(t.labelForm).then((function(e){t.$message({message:"编辑成功",type:"success"}),t.initData(),t.labelVisible=!1})).catch((function(e){console.log(e)}))}}))},submitClick:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;r.insertLabels(t.labelForm).then((function(a){t.$message({message:"新建标签成功",type:"success"}),t.initData(),t.$refs[e].resetFields()})).catch((function(e){console.log(e)}))}))}}},h=u,b=(a("ecb4"),a("2877")),f=Object(b["a"])(h,l,n,!1,null,"ce8cac1c",null);t["default"]=f.exports},d4ec:function(e,t,a){"use strict";function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a.d(t,"a",(function(){return l}))},ecb4:function(e,t,a){"use strict";a("a9bc")}}]);
//# sourceMappingURL=chunk-1cb849c2.302bd075.js.map