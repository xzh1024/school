(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-221e7179"],{"494c":function(e,t,a){"use strict";a("a32c")},a15b:function(e,t,a){"use strict";var s=a("23e7"),n=a("44ad"),l=a("fc6a"),i=a("a640"),o=[].join,r=n!=Object,c=i("join",",");s({target:"Array",proto:!0,forced:r||!c},{join:function(e){return o.call(l(this),void 0===e?",":e)}})},a32c:function(e,t,a){},bee2:function(e,t,a){"use strict";function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function n(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}a.d(t,"a",(function(){return n}))},d4ec:function(e,t,a){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a.d(t,"a",(function(){return s}))},d829:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["union_stock_group",e.$store.state.paddingLeft],staticStyle:{"min-width":"1250px"},attrs:{id:"page-union_stock_group"}},[a("div",{staticClass:"label_manage"},[a("div",{staticClass:"label_search"},[a("el-input",{staticStyle:{width:"300px"},attrs:{size:"small",placeholder:"分组名称或仓库名称","suffix-icon":"el-icon-search"},model:{value:e.searchIpt,callback:function(t){e.searchIpt=t},expression:"searchIpt"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.searchFn}},[e._v("查询")]),a("el-button",{attrs:{size:"small"},on:{click:e.resetFn}},[e._v("重置")])],1),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary",size:"small"},on:{click:e.addLabelFn}},[e._v("新建分组")]),a("el-table",{ref:"multipleTable",staticClass:"xtable",staticStyle:{width:"100%"},attrs:{size:"small",data:e.tableData,border:"",stripe:"","max-height":"650","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),a("el-table-column",{attrs:{prop:"name",label:"分组名称",align:"center","min-width":"400"}}),a("el-table-column",{attrs:{prop:"warehouseNames",label:"关联仓库",align:"center","min-width":"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"#6589F8"}},[e._v(e._s(e.renderRow(t.row)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editClick(t.row,t.$index)}}},[e._v("编辑")]),a("el-button",{staticClass:"txt_danger",attrs:{type:"text",size:"small"},on:{click:function(a){return e.delClick(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"page_footer"},[a("div",[a("el-checkbox",{on:{change:function(t){return e.tableDataChange(e.tableData)}},model:{value:e.searchResult,callback:function(t){e.searchResult=t},expression:"searchResult"}},[e._v("全选当前查询结果")]),a("span",{staticStyle:{margin:"0 6px",padding:"0px 6px","border-left":"1px solid #000","border-right":"1px solid #000"}},[e._v("已选中 "+e._s(e.selection.length)+" 条")]),a("span",[e._v("批量操作")]),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{plain:"",size:"small",type:"danger"},on:{click:e.allDeleteFn}},[e._v("删除")])],1),a("el-pagination",{attrs:{"current-page":e.pageInfo.page,"page-sizes":[10,20,30,40],"page-size":e.pageInfo.pageSize,layout:"total, prev, pager, next, jumper, sizes",total:e.pageInfo.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:e.labelTitle,"close-on-click-modal":!1,visible:e.labelVisible,width:"30%"},on:{"update:visible":function(t){e.labelVisible=t}}},[a("el-form",{ref:"labelForm",staticClass:"demo-ruleForm",attrs:{model:e.labelForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分组名称",prop:"name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.labelForm.name,callback:function(t){e.$set(e.labelForm,"name",t)},expression:"labelForm.name"}})],1),a("el-form-item",{attrs:{label:"关联仓库",prop:"warehouseNames"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",multiple:"",filterable:"",placeholder:"请选择关联仓库"},model:{value:e.labelForm.warehouseNos,callback:function(t){e.$set(e.labelForm,"warehouseNos",t)},expression:"labelForm.warehouseNos"}},e._l(e.houseList,(function(e){return a("el-option",{key:e.warehouseNo,attrs:{label:e.warehouseName,value:e.warehouseNo,disabled:e.disabled}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.cancelClick("labelForm")}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.saveClick("labelForm")}}},[e._v("保存")]),"新建分组"==e.labelTitle?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitClick("labelForm")}}},[e._v("保存并新建")]):e._e()],1)],1)],1)},n=[],l=(a("159b"),a("99af"),a("a15b"),a("5319"),a("ac1f"),a("b0c0"),a("d4ec")),i=a("bee2"),o=a("b775"),r=function(){function e(){Object(l["a"])(this,e)}return Object(i["a"])(e,[{key:"getStockInfo",value:function(e){return Object(o["b"])({baseURL:o["a"].accounts,url:"/companies/warehouse-groups",method:"get",params:e})}},{key:"getWarehouse",value:function(e){return Object(o["b"])({baseURL:o["a"].accounts,url:"/companies/warehouse-groups/warehouses",method:"get",params:e})}},{key:"deleteWarehouse",value:function(e){return Object(o["b"])({baseURL:o["a"].accounts,url:"/companies/warehouse-groups",method:"delete",data:e})}},{key:"insertWarehouse",value:function(e){return Object(o["b"])({baseURL:o["a"].accounts,url:"/companies/warehouse-groups",method:"post",data:e})}},{key:"updateWarehouse",value:function(e){return Object(o["b"])({baseURL:o["a"].accounts,url:"/companies/warehouse-groups/".concat(e.id),method:"post",data:e})}}]),e}(),c=new r,u={name:"union_stock_group",data:function(){return{tableData:[],multipleSelection:[],selection:[],searchIpt:"",pageInfo:{page:1,totalSize:0,pageSize:20},searchResult:!1,labelVisible:!1,labelTitle:"新建分组",labelForm:{name:"",warehouseNos:[]},houseList:[],rules:{name:[{required:!0,message:"请输入分组名称",trigger:"blur"},{max:10,message:"最多支持输入10个字符",trigger:"blur"}]},editIndex:-1,searchAll:!1,hasWarehouse:[]}},created:function(){this.getWarehouse()},mounted:function(){this.initData()},methods:{getWarehouse:function(){var e=this;this.houseList=[],c.getWarehouse().then((function(t){e.houseList=t})).catch((function(e){console.log(e)}))},initData:function(){var e=this,t={page:this.pageInfo.page,pageSize:this.pageInfo.pageSize,name:this.searchIpt};this.tableData=[],c.getStockInfo(t).then((function(t){e.tableData=t.rows?t.rows:[],e.pageInfo.totalSize=t.totalSize,e.hasWarehouseFn()})).catch((function(e){console.log(e)}))},hasWarehouseFn:function(){var e=this;this.hasWarehouse=[],this.tableData.forEach((function(t){e.hasWarehouse=e.hasWarehouse.concat(t.warehouseNos)})),this.houseList.forEach((function(t){e.hasWarehouse.forEach((function(e){e==t.warehouseNo&&(t.disabled=!0)}))}))},searchFn:function(){this.initData(),this.$refs.multipleTable.clearSelection(),this.searchResult=!1},resetFn:function(){this.searchIpt="",this.searchFn()},renderRow:function(e){var t=e.warehouseNames?e.warehouseNames.join("、"):"";return t},toReplaceClick:function(e){window.location.replace("#/union_goods_stock")},editClick:function(e,t){this.labelTitle="编辑分组",this.editIndex=t,this.labelVisible=!0,this.labelForm=Object.assign({},e);var a=e.warehouseNos;this.houseList.forEach((function(e){a.forEach((function(t){t==e.warehouseNo&&(e.disabled=!1)}))}))},handleSelectionChange:function(e){this.multipleSelection=e,this.selection=e},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.pageInfo.page=1,this.initData()},handleCurrentChange:function(e){this.pageInfo.page=e,this.initData()},delClick:function(e,t){var a=this;this.searchAll=!1,this.$confirm("你确定要删除当前分组吗？").then((function(t){a.deleteFn(e,0)})).catch((function(e){}))},deleteFn:function(e,t){var a=this,s={};t?(s={searchAll:this.searchAll,cond:{name:this.searchIpt},ids:[]},e.forEach((function(e){s.ids.push(e.id)}))):s={searchAll:this.searchAll,cond:{name:this.searchIpt},ids:[e.id]},c.deleteWarehouse(s).then((function(e){a.$message({message:"删除成功",type:"success"}),a.searchFn()})).catch((function(e){console.log(e)}))},allDeleteFn:function(){var e=this;if(!this.selection.length)return this.$message({message:"你还没有选择数据",type:"warning"}),!1;this.$confirm("你确定要删除当前分组吗？").then((function(t){e.deleteFn(e.selection,1)})).catch((function(t){e.$message.error(t)}))},tableDataChange:function(e){this.toggleSelection(e)},toggleSelection:function(e){var t=this;e?(this.searchAll=!0,e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)}))):(this.searchAll=!1,this.$refs.multipleTable.clearSelection())},addLabelFn:function(){this.labelTitle="新建分组",this.labelVisible=!0,this.labelForm={name:"",warehouseNos:[]}},cancelClick:function(e){this.labelVisible=!1,this.$refs[e].resetFields()},saveClick:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if("新建分组"==t.labelTitle)c.insertWarehouse(t.labelForm).then((function(e){t.$message({message:"新建分组成功",type:"success"}),t.initData(),t.labelVisible=!1,t.labelForm={name:"",warehouseNos:[]}})).catch((function(e){console.log(e)}));else{var a={id:t.labelForm.id,name:t.labelForm.name,warehouseNos:t.labelForm.warehouseNos};c.updateWarehouse(a).then((function(e){t.$message({message:"编辑成功",type:"success"}),t.initData(),t.labelVisible=!1})).catch((function(e){console.log(e)}))}}))},submitClick:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;c.insertWarehouse(t.labelForm).then((function(a){t.$message({message:"新建分组成功",type:"success"}),t.initData(),t.$refs[e].resetFields(),t.labelForm={name:"",warehouseNos:[]}})).catch((function(e){console.log(e)}))}))}}},h=u,f=(a("494c"),a("2877")),b=Object(f["a"])(h,s,n,!1,null,"1e4b9112",null);t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-221e7179.78f2ace6.js.map