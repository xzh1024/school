(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c3cc2358"],{"14af":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gradeRules"},[e.data.isEditing?a("div",[e.data.rules?a("div",{staticClass:"edit_rules"},[a("p",[a("el-radio-group",{on:{change:e.radioChangeFn},model:{value:e.data.rules.condType,callback:function(t){e.$set(e.data.rules,"condType",t)},expression:"data.rules.condType"}},[a("el-radio",{staticStyle:{"margin-right":"16px"},attrs:{label:1}},[e._v("满足勾选的任一条件")]),a("el-radio",{staticStyle:{"margin-right":"16px"},attrs:{label:2}},[e._v("满足勾选的全部条件")]),e.isNoway?e._e():a("el-radio",{attrs:{label:3}},[e._v("无门槛")])],1)],1),e._l(e.data.rules.details,(function(t,n){return[a("p",{key:n},[a("el-checkbox",{attrs:{disabled:e.checkboxDisabled},on:{change:function(a){return e.checkboxChangeFn(a,t)}},model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}}),0!=t.type?a("el-select",{staticStyle:{width:"100px",margin:"4px 8px"},attrs:{disabled:e.checkboxDisabled,size:"mini",placeholder:"请选择"},on:{change:e.changeFn},model:{value:t.period,callback:function(a){e.$set(t,"period",a)},expression:"item.period"}},e._l(e.timeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("span",{staticStyle:{"margin-right":"10px"},style:{marginLeft:0==t.type?"8px":""}},[e._v(" "+e._s(e.renderTypeName(t)))]),0!=t.type?a("el-input",{staticStyle:{width:"100px"},attrs:{disabled:e.checkboxDisabled,type:"number",size:"mini",min:0},on:{change:function(a){return e.InputChange(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e._v(" "+e._s(2==t.type?"笔":0==t.type?"":"元")+" ")],1)]}))],2):e._e()]):a("div",[e.data.rules?a("div",[a("p",[e._v(e._s(1==e.data.rules.condType?"满足以下任一条件":2==e.data.rules.condType?"满足以下全部条件":"无门槛"))]),e._l(e.data.rules.details,(function(t,n){return[t.checked?a("p",{key:n},[e._v(e._s(e.renderFn(t)))]):e._e()]}))],2):e._e(),e.isEmpty?a("div",[e._v("无门槛")]):e._e()])])},i=[],s=(a("159b"),a("a9e3"),a("b680"),{name:"gradeRules",data:function(){return{data:{},details:[],timeList:[{label:"历史累计",value:1},{label:"近1年",value:2},{label:"近3月",value:3},{label:"近1月",value:4},{label:"近7天",value:5},{label:"近1天",value:6}],checkboxDisabled:!1,isEmpty:!1}},props:{isEditing:Boolean,isNoway:Boolean,dataObj:Object},watch:{dataObj:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){this.data=this.dataObj,this.isNoway&&(this.checkboxDisabled=!1)},renderFn:function(e){var t="",a="",n="",i="";return 1==e.period?t="历史累计":2==e.period?t="近1年":3==e.period?t="近3月":4==e.period?t="近1月":5==e.period?t="近7天":6==e.period&&(t="近1天"),n=e.value,0==e.type?(t="",a="无门槛",n="",i=""):1==e.type?(a="购买金额达",i="元"):2==e.type?(a="消费次数达",i="笔"):3==e.type?(a="回款金额达",i="元"):4==e.type&&(a="充值金额达",i="元"),t+a+n+i},renderTypeName:function(e){var t="";return 0==e.type?t="无门槛":1==e.type?t="购买金额达":2==e.type?t="消费次数达":3==e.type?t="回款金额达":4==e.type&&(t="充值金额达"),t},radioChangeFn:function(e){3==e?(this.data.rules.details.forEach((function(e){e.type&&(e.checked=!1)})),this.checkboxDisabled=!0):this.checkboxDisabled=!1,this.changeFn()},checkboxChangeFn:function(e,t){this.changeFn()},changeFn:function(){this.$emit("change",this.data)},InputChange:function(e){e.value&&Number(e.value||0)<0&&(e.value="0"),e.value&&2!=e.type&&(e.value=Number(e.value).toFixed(2)),e.value&&2==e.type&&(e.value=Number(e.value).toFixed(0)),this.$forceUpdate(),this.$emit("change",this.data)}}}),r=s,c=(a("64cd"),a("2877")),l=Object(c["a"])(r,n,i,!1,null,"21f316e2",null);t["a"]=l.exports},6343:function(e,t,a){},"64cd":function(e,t,a){"use strict";a("6343")},"79eb":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.VipVisible,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(t){e.VipVisible=t},close:e.closedFn}},[a("div",[a("el-table",{ref:"multipleTable",staticClass:"xtable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{size:"small",data:e.tableData,border:"",stripe:"","tooltip-effect":"dark","max-height":e.maxHeight}},[a("el-table-column",{attrs:{type:"radio",align:"center",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row.id,disabled:e.isAutoUpgrade},on:{change:function(a){return e.handleRowChange(t.row)}},model:{value:e.selectId,callback:function(t){e.selectId=t},expression:"selectId"}},[e._v(e._s(""))])]}}])}),a("el-table-column",{attrs:{prop:"no",label:"会员等级",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:{color:t.row.color}},[e._v(" "+e._s(t.row.no)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"name",label:"名称",align:"center",width:"150"}}),a("el-table-column",{attrs:{prop:"rules",label:"等级规则",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("GradeRules",{attrs:{dataObj:e.row}})]}}])})],1),a("p",{staticClass:"tip_txt"},[e._v(" 客户等级自动升级时不能手动配置会员等级，自动升级关闭时可为客户设置任意等级 ")]),a("p",[a("span",[e._v("当前自动升级已")]),a("span",{staticClass:"tip_warning"},[e._v(e._s(e.isAutoUpgrade?"开启":"关闭"))]),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("可前往: 客户 -> 会员等级【配置等级更新模式】中进行修改")])])],1),a("div",{staticStyle:{"text-align":"right","margin-top":"8px"}},[a("el-button",{attrs:{size:"small"},on:{click:e.cancelVip}},[e._v("取消")]),e.isAutoUpgrade?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.sureVip}},[e._v("确定")])],1)])},i=[],s=(a("159b"),a("14af")),r=a("d4ec"),c=a("bee2"),l=a("b775"),o=function(){function e(){Object(r["a"])(this,e)}return Object(c["a"])(e,[{key:"getCustomersList",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/customers",method:"get",params:e})}},{key:"setsCustomers",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/customers/sets",method:"post",data:e})}},{key:"getMemberGradeAutoUpgrade",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/members-grades/auto-upgrade",method:"get",params:e})}},{key:"agree",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/customers/".concat(e.id,"/agree"),method:"post",data:e})}},{key:"refuse",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/customers/".concat(e.id,"/refuse"),method:"post",data:e})}},{key:"getLabelList",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/companies/labels",method:"get",params:e})}},{key:"getErpList",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/customers/erp",method:"get",params:e})}},{key:"getMemberGradeList",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/members-grades",method:"get",params:e})}},{key:"getDicts",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/dicts",method:"get",params:e})}},{key:"getStaffsBycid",value:function(e){return Object(l["b"])({baseURL:l["a"].accounts,url:"/staffs/by-cid",method:"get",params:e})}}]),e}(),u=new o,d={name:"setVipGrade",components:{GradeRules:s["a"]},data:function(){return{VipVisible:!1,title:"修改会员等级",tableData:[],maxHeight:"300",selectId:0,isAutoUpgrade:!1}},props:{selectData:Array,searchAll:Boolean,searchCond:Object},watch:{selectData:function(){this.onLoad()}},created:function(){this.init(),this.getMemberGradeAutoUpgrade()},methods:{show:function(){this.VipVisible=!0},closedFn:function(){this.VipVisible=!1},getMemberGradeAutoUpgrade:function(){var e=this;u.getMemberGradeAutoUpgrade().then((function(t){e.isAutoUpgrade=t}))},init:function(){var e=this;this.tableData=[{id:0,name:"无",no:"0",rules:{}}],u.getMemberGradeList().then((function(t){t&&t.forEach((function(t){1==t.status&&e.tableData.push(t)}))}))},onLoad:function(){if(1==this.selectData.length){if(void 0==this.selectData[0].id)return;var e=void 0!=this.selectData[0].memberGradeId?this.selectData[0].memberGradeId:this.selectData[0].memberGrade.id;this.selectId=e}},handleRowChange:function(e){this.selectId=e.id},cancelVip:function(){this.closedFn()},sureVip:function(){var e=this,t={ids:[],searchAll:this.searchAll,searchCond:this.searchCond,memberGradeId:this.selectId};this.selectData.forEach((function(e){t.ids.push(e.id)})),u.setsCustomers(t).then((function(t){e.VipVisible=!1,e.$message.success("修改会员等级成功"),e.$emit("onRefresh",!0)}))}}},b=d,p=(a("b7bf"),a("2877")),h=Object(p["a"])(b,n,i,!1,null,"75a8d7b1",null);t["a"]=h.exports},ab0c:function(e,t,a){},b7bf:function(e,t,a){"use strict";a("ab0c")},bee2:function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}a.d(t,"a",(function(){return i}))},d4ec:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=chunk-c3cc2358.e5494409.js.map