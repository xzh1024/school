{"version":3,"sources":["webpack:///./node_modules/core-js/internals/string-repeat.js","webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./node_modules/core-js/modules/es.regexp.constructor.js","webpack:///./node_modules/spark-md5/spark-md5.js","webpack:///./node_modules/exif-js/exif.js","webpack:///./node_modules/qiniu-js/esm/base64.js","webpack:///./node_modules/qiniu-js/esm/utils.js","webpack:///./node_modules/qiniu-js/esm/statisticsLog.js","webpack:///./node_modules/qiniu-js/esm/config.js","webpack:///./node_modules/qiniu-js/esm/pool.js","webpack:///./node_modules/qiniu-js/esm/api.js","webpack:///./node_modules/qiniu-js/esm/upload/base.js","webpack:///./node_modules/qiniu-js/esm/upload/resume.js","webpack:///./node_modules/qiniu-js/esm/upload/direct.js","webpack:///./node_modules/qiniu-js/esm/upload/index.js","webpack:///./node_modules/qiniu-js/esm/observable.js","webpack:///./node_modules/qiniu-js/esm/compress.js","webpack:///./node_modules/qiniu-js/esm/index.js"],"names":["toInteger","requireObjectCoercible","module","exports","repeat","count","str","String","this","result","n","Infinity","RangeError","redefine","anObject","fails","flags","TO_STRING","RegExpPrototype","RegExp","prototype","nativeToString","NOT_GENERIC","call","source","INCORRECT_NAME","name","R","p","rf","f","undefined","unsafe","DESCRIPTORS","global","isForced","inheritIfRequired","defineProperty","getOwnPropertyNames","isRegExp","getFlags","stickyHelpers","setInternalState","set","setSpecies","wellKnownSymbol","MATCH","NativeRegExp","re1","re2","CORRECT_NEW","UNSUPPORTED_Y","FORCED","RegExpWrapper","pattern","sticky","thisIsRegExp","patternIsRegExp","flagsAreUndefined","constructor","indexOf","replace","proxy","key","configurable","get","it","keys","index","length","factory","hex_chr","md5cycle","x","k","a","b","c","d","md5blk","s","i","md5blks","charCodeAt","md5blk_array","md51","tail","tmp","lo","hi","state","substring","toString","match","parseInt","md51_array","subarray","Uint8Array","rhex","j","hex","join","toUtf8","test","unescape","encodeURIComponent","utf8Str2ArrayBuffer","returnUInt8Array","buff","ArrayBuffer","arr","arrayBuffer2Utf8Str","fromCharCode","apply","concatenateArrayBuffers","first","second","byteLength","buffer","hexToBinaryString","bytes","push","substr","SparkMD5","reset","y","lsw","msw","slice","clamp","val","Math","max","min","from","to","num","target","targetArray","sourceArray","begin","end","append","appendBinary","contents","_buff","_length","_hash","raw","ret","_finish","getState","hash","setState","destroy","hashBinary","content","debug","EXIF","obj","EXIFwrapped","ExifTags","Tags","TiffTags","GPSTags","0","IFD1Tags","StringValues","ExposureProgram","1","2","3","4","5","6","7","8","MeteringMode","255","LightSource","9","10","11","12","13","14","15","17","18","19","20","21","22","23","24","Flash","SensingMethod","SceneCaptureType","SceneType","CustomRendered","WhiteBalance","GainControl","Contrast","Saturation","Sharpness","SubjectDistanceRange","FileSource","Components","imageHasData","img","base64ToArrayBuffer","base64","contentType","binary","atob","len","view","objectURLToBlob","url","callback","http","XMLHttpRequest","open","responseType","onload","e","status","response","send","getImageData","handleBinaryFile","binFile","data","findEXIFinJPEG","exifdata","iptcdata","findIPTCinJPEG","isXmpEnabled","xmpdata","findXMPinJPEG","src","arrayBuffer","fileReader","FileReader","blob","readAsArrayBuffer","self","Blob","File","console","log","file","dataView","DataView","getUint8","marker","offset","readEXIFData","getUint16","isFieldSegmentStart","nameHeaderLength","startOffset","sectionLength","readIPTCData","IptcFieldMap","fieldValue","fieldName","dataSize","segmentType","segmentStartPos","getInt16","getStringFromDB","hasOwnProperty","Array","readTags","tiffStart","dirStart","strings","bigEnd","entryOffset","tag","entries","tags","readTagValue","vals","numerator","denominator","type","numValues","getUint32","valueOffset","Number","getInt32","getNextIFDOffset","readThumbnailImage","firstIFDOffset","IFD1OffsetPointer","thumbTags","JpegIFOffset","JpegIFByteCount","tOffset","tLength","start","outstr","exifData","gpsData","tiffOffset","ExifIFDPointer","GPSInfoIFDPointer","dom","DOMParser","xmpString","xmpEndIndex","indexOfXmp","domDocument","parseFromString","xml2Object","xml2json","xml","json","nodeType","attributes","attribute","item","nodeName","nodeValue","hasChildNodes","childNodes","child","old","children","idx","itemAtt","dataKey","dataValue","textContent","message","enableXmp","disableXmp","getData","Image","HTMLImageElement","complete","getTag","getIptcTag","getAllTags","getAllIptcTags","pretty","strPretty","readFromBinaryFile","utf8Encode","argString","string","utftext","stringl","c1","enc","c2","base64Encode","o1","o2","o3","h1","h2","h3","h4","bits","b64","ac","tmp_arr","charAt","base64Decode","dec","urlSafeBase64Encode","v","urlSafeBase64Decode","__assign","Object","assign","t","arguments","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","rejected","done","then","__generator","body","g","_","label","sent","trys","ops","verb","Symbol","iterator","op","TypeError","pop","MB","pow","getChunks","blockSize","chunkByteSize","size","chunks","ceil","chunk","isMetaDataValid","params","every","isCustomVarsValid","sum","list","reduce","loaded","setLocalFileInfo","localKey","info","localStorage","setItem","JSON","stringify","err","window","warn","createLocalKey","removeLocalFileInfo","removeItem","getLocalFileInfo","localInfo","getItem","parse","getAuthHeaders","token","auth","Authorization","getHeadersForChunkUpload","header","getHeadersForMkFile","createXHR","ActiveXObject","computeMd5","spark","_a","reader","evt","Error","onerror","request","options","xhr","method","onCreate","headers","headers_1","forEach","setRequestHeader","upload","addEventListener","lengthComputable","onProgress","total","onreadystatechange","responseText","readyState","reqId","getResponseHeader","code","isRequestError","getPortFromUrl","groups","getDomainFromUrl","getPutPolicy","segments","split","ak","putPolicy","bucket","scope","createObjectURL","URL","webkitURL","mozURL","getTransform","image","orientation","width","height","matrix","StatisticsLogger","logString","values","retryCount","_this","Pool","runTask","limit","queue","processing","enqueue","task","check","run","filter","processingNum","availableNum","region","z0","z1","z2","na0","as0","regionUphostMap","srcUphost","cdnUphost","getUpHosts","protocol","getUploadUrl","config","upHosts","host","res","hosts","upprotocol","uphost","useCdnDomain","up","acc","main","getBaseUrl","uploadInfo","id","initUploadParts","uploadUrl","uploadChunk","uploadComplete","DEFAULT_CHUNK_SIZE","GB","Base","handlers","statisticsLogger","xhrList","aborted","disableStatisticsReport","checkByMD5","forceDirect","chunkSize","concurrentRequestLimit","putExtra","fname","onData","onError","onComplete","putFile","err_1","needRetry","notReachRetryCount","_b","customVars","metadata","uploadAt","Date","getTime","sendLog","clear","abort","stop","addXhr","remoteIp","port","duration","time","floor","bytesSent","progress","upType","getProgressInfoItem","percent","__extends","extendStatics","setPrototypeOf","__proto__","__","create","isPositiveInteger","re","_super","Resume","pool","uploadChunks","initBeforeUploadChunks","chunkInfo","map","all","mkFileReq","getLocalKey","shouldCheckMD5","reuseSaved","md5","requestOptions","uploadedList","updateChunkProgress","getUploadInfo","etag","uploadId","parts","partNumber","mimeType","updateMkFileProgress","mkFileProgress","notifyResumeProgress","Direct","formData","customVars_1","FormData","updateDirectProgress","finishDirectProgress","createUploadManager","Subscription","closed","unsubscribe","_unsubscribe","add","teardown","Subscriber","observerOrNext","error","isStopped","destination","Observable","_subscribe","subscribe","sink","__read","o","m","r","ar","__spread","concat","PNG","JPEG","WEBP","BMP","maxSteps","scaleFactor","supportMimeTypes","defaultType","isSupportedType","includes","Compress","quality","noCompressIfLarger","process","srcDimension","originImage","canvas","scale","scaleCanvas","distBlob","outputType","getOriginImage","getCanvas","maxWidth","maxHeight","doScale","toBlob","dist","ctx","fillStyle","fillRect","clearRect","document","createElement","context","getContext","transform","drawImage","sctx","steps","factor","mirror","mctx","originWidth","originHeight","dw","dh","putImageData","dataURL","toDataURL","char","compressImage","compress","observer","manager","bind"],"mappings":"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","file":"js/chunk-5e172a12.0b2b5b83.js","sourcesContent":["'use strict';\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.repeat` method implementation\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\nmodule.exports = ''.repeat || function repeat(count) {\n  var str = String(requireObjectCoercible(this));\n  var result = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","'use strict';\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\nvar flags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar nativeToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = String(R.source);\n    var rf = R.flags;\n    var f = String(rf === undefined && R instanceof RegExp && !('flags' in RegExpPrototype) ? flags.call(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","var DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar isRegExp = require('../internals/is-regexp');\nvar getFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar setInternalState = require('../internals/internal-state').set;\nvar setSpecies = require('../internals/set-species');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\nvar NativeRegExp = global.RegExp;\nvar RegExpPrototype = NativeRegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n\n// \"new\" should create a new object, old webkit bug\nvar CORRECT_NEW = new NativeRegExp(re1) !== re1;\n\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;\n\nvar FORCED = DESCRIPTORS && isForced('RegExp', (!CORRECT_NEW || UNSUPPORTED_Y || fails(function () {\n  re2[MATCH] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';\n})));\n\n// `RegExp` constructor\n// https://tc39.es/ecma262/#sec-regexp-constructor\nif (FORCED) {\n  var RegExpWrapper = function RegExp(pattern, flags) {\n    var thisIsRegExp = this instanceof RegExpWrapper;\n    var patternIsRegExp = isRegExp(pattern);\n    var flagsAreUndefined = flags === undefined;\n    var sticky;\n\n    if (!thisIsRegExp && patternIsRegExp && pattern.constructor === RegExpWrapper && flagsAreUndefined) {\n      return pattern;\n    }\n\n    if (CORRECT_NEW) {\n      if (patternIsRegExp && !flagsAreUndefined) pattern = pattern.source;\n    } else if (pattern instanceof RegExpWrapper) {\n      if (flagsAreUndefined) flags = getFlags.call(pattern);\n      pattern = pattern.source;\n    }\n\n    if (UNSUPPORTED_Y) {\n      sticky = !!flags && flags.indexOf('y') > -1;\n      if (sticky) flags = flags.replace(/y/g, '');\n    }\n\n    var result = inheritIfRequired(\n      CORRECT_NEW ? new NativeRegExp(pattern, flags) : NativeRegExp(pattern, flags),\n      thisIsRegExp ? this : RegExpPrototype,\n      RegExpWrapper\n    );\n\n    if (UNSUPPORTED_Y && sticky) setInternalState(result, { sticky: sticky });\n\n    return result;\n  };\n  var proxy = function (key) {\n    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {\n      configurable: true,\n      get: function () { return NativeRegExp[key]; },\n      set: function (it) { NativeRegExp[key] = it; }\n    });\n  };\n  var keys = getOwnPropertyNames(NativeRegExp);\n  var index = 0;\n  while (keys.length > index) proxy(keys[index++]);\n  RegExpPrototype.constructor = RegExpWrapper;\n  RegExpWrapper.prototype = RegExpPrototype;\n  redefine(global, 'RegExp', RegExpWrapper);\n}\n\n// https://tc39.es/ecma262/#sec-get-regexp-@@species\nsetSpecies('RegExp');\n","(function (factory) {\n    if (typeof exports === 'object') {\n        // Node/CommonJS\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD\n        define(factory);\n    } else {\n        // Browser globals (with support for web workers)\n        var glob;\n\n        try {\n            glob = window;\n        } catch (e) {\n            glob = self;\n        }\n\n        glob.SparkMD5 = factory();\n    }\n}(function (undefined) {\n\n    'use strict';\n\n    /*\n     * Fastest md5 implementation around (JKM md5).\n     * Credits: Joseph Myers\n     *\n     * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n     * @see http://jsperf.com/md5-shootout/7\n     */\n\n    /* this function is much faster,\n      so if possible we use it. Some IEs\n      are the only ones I know of that\n      need the idiotic second function,\n      generated by an if clause.  */\n    var add32 = function (a, b) {\n        return (a + b) & 0xFFFFFFFF;\n    },\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\n\n\n    function cmn(q, a, b, x, s, t) {\n        a = add32(add32(a, q), add32(x, t));\n        return add32((a << s) | (a >>> (32 - s)), b);\n    }\n\n    function md5cycle(x, k) {\n        var a = x[0],\n            b = x[1],\n            c = x[2],\n            d = x[3];\n\n        a += (b & c | ~b & d) + k[0] - 680876936 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[1] - 389564586 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[2] + 606105819 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[3] - 1044525330 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[4] - 176418897 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[5] + 1200080426 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[6] - 1473231341 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[7] - 45705983 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[8] + 1770035416 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[9] - 1958414417 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[10] - 42063 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[11] - 1990404162 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[12] + 1804603682 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[13] - 40341101 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[14] - 1502002290 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[15] + 1236535329 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n\n        a += (b & d | c & ~d) + k[1] - 165796510 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[6] - 1069501632 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[11] + 643717713 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[0] - 373897302 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[5] - 701558691 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[10] + 38016083 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[15] - 660478335 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[4] - 405537848 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[9] + 568446438 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[14] - 1019803690 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[3] - 187363961 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[8] + 1163531501 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[13] - 1444681467 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[2] - 51403784 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[7] + 1735328473 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[12] - 1926607734 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n\n        a += (b ^ c ^ d) + k[5] - 378558 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[8] - 2022574463 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[11] + 1839030562 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[14] - 35309556 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[1] - 1530992060 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[4] + 1272893353 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[7] - 155497632 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[10] - 1094730640 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[13] + 681279174 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[0] - 358537222 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[3] - 722521979 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[6] + 76029189 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[9] - 640364487 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[12] - 421815835 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[15] + 530742520 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[2] - 995338651 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n\n        a += (c ^ (b | ~d)) + k[0] - 198630844 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[7] + 1126891415 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[14] - 1416354905 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[5] - 57434055 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[12] + 1700485571 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[3] - 1894986606 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[10] - 1051523 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[1] - 2054922799 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[8] + 1873313359 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[15] - 30611744 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[6] - 1560198380 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[13] + 1309151649 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[4] - 145523070 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[11] - 1120210379 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[2] + 718787259 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[9] - 343485551 | 0;\n        b  = (b << 21 | b >>> 11) + c | 0;\n\n        x[0] = a + x[0] | 0;\n        x[1] = b + x[1] | 0;\n        x[2] = c + x[2] | 0;\n        x[3] = d + x[3] | 0;\n    }\n\n    function md5blk(s) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n        }\n        return md5blks;\n    }\n\n    function md5blk_array(a) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n        }\n        return md5blks;\n    }\n\n    function md51(s) {\n        var n = s.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk(s.substring(i - 64, i)));\n        }\n        s = s.substring(i - 64);\n        length = s.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n        }\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n        return state;\n    }\n\n    function md51_array(a) {\n        var n = a.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n        }\n\n        // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n        // containing the last element of the parent array if the sub array specified starts\n        // beyond the length of the parent array - weird.\n        // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n        a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n        length = a.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= a[i] << ((i % 4) << 3);\n        }\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n\n        return state;\n    }\n\n    function rhex(n) {\n        var s = '',\n            j;\n        for (j = 0; j < 4; j += 1) {\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n        }\n        return s;\n    }\n\n    function hex(x) {\n        var i;\n        for (i = 0; i < x.length; i += 1) {\n            x[i] = rhex(x[i]);\n        }\n        return x.join('');\n    }\n\n    // In some cases the fast add32 function cannot be used..\n    if (hex(md51('hello')) !== '5d41402abc4b2a76b9719d911017c592') {\n        add32 = function (x, y) {\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n            return (msw << 16) | (lsw & 0xFFFF);\n        };\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * ArrayBuffer slice polyfill.\n     *\n     * @see https://github.com/ttaubert/node-arraybuffer-slice\n     */\n\n    if (typeof ArrayBuffer !== 'undefined' && !ArrayBuffer.prototype.slice) {\n        (function () {\n            function clamp(val, length) {\n                val = (val | 0) || 0;\n\n                if (val < 0) {\n                    return Math.max(val + length, 0);\n                }\n\n                return Math.min(val, length);\n            }\n\n            ArrayBuffer.prototype.slice = function (from, to) {\n                var length = this.byteLength,\n                    begin = clamp(from, length),\n                    end = length,\n                    num,\n                    target,\n                    targetArray,\n                    sourceArray;\n\n                if (to !== undefined) {\n                    end = clamp(to, length);\n                }\n\n                if (begin > end) {\n                    return new ArrayBuffer(0);\n                }\n\n                num = end - begin;\n                target = new ArrayBuffer(num);\n                targetArray = new Uint8Array(target);\n\n                sourceArray = new Uint8Array(this, begin, num);\n                targetArray.set(sourceArray);\n\n                return target;\n            };\n        })();\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * Helpers.\n     */\n\n    function toUtf8(str) {\n        if (/[\\u0080-\\uFFFF]/.test(str)) {\n            str = unescape(encodeURIComponent(str));\n        }\n\n        return str;\n    }\n\n    function utf8Str2ArrayBuffer(str, returnUInt8Array) {\n        var length = str.length,\n           buff = new ArrayBuffer(length),\n           arr = new Uint8Array(buff),\n           i;\n\n        for (i = 0; i < length; i += 1) {\n            arr[i] = str.charCodeAt(i);\n        }\n\n        return returnUInt8Array ? arr : buff;\n    }\n\n    function arrayBuffer2Utf8Str(buff) {\n        return String.fromCharCode.apply(null, new Uint8Array(buff));\n    }\n\n    function concatenateArrayBuffers(first, second, returnUInt8Array) {\n        var result = new Uint8Array(first.byteLength + second.byteLength);\n\n        result.set(new Uint8Array(first));\n        result.set(new Uint8Array(second), first.byteLength);\n\n        return returnUInt8Array ? result : result.buffer;\n    }\n\n    function hexToBinaryString(hex) {\n        var bytes = [],\n            length = hex.length,\n            x;\n\n        for (x = 0; x < length - 1; x += 2) {\n            bytes.push(parseInt(hex.substr(x, 2), 16));\n        }\n\n        return String.fromCharCode.apply(String, bytes);\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation.\n     *\n     * Use this class to perform an incremental md5, otherwise use the\n     * static methods instead.\n     */\n\n    function SparkMD5() {\n        // call reset to init the instance\n        this.reset();\n    }\n\n    /**\n     * Appends a string.\n     * A conversion will be applied if an utf8 string is detected.\n     *\n     * @param {String} str The string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.append = function (str) {\n        // Converts the string to utf8 bytes if necessary\n        // Then append as binary\n        this.appendBinary(toUtf8(str));\n\n        return this;\n    };\n\n    /**\n     * Appends a binary string.\n     *\n     * @param {String} contents The binary string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.appendBinary = function (contents) {\n        this._buff += contents;\n        this._length += contents.length;\n\n        var length = this._buff.length,\n            i;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk(this._buff.substring(i - 64, i)));\n        }\n\n        this._buff = this._buff.substring(i - 64);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            i,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.reset = function () {\n        this._buff = '';\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.prototype.getState = function () {\n        return {\n            buff: this._buff,\n            length: this._length,\n            hash: this._hash.slice()\n        };\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.setState = function (state) {\n        this._buff = state.buff;\n        this._length = state.length;\n        this._hash = state.hash;\n\n        return this;\n    };\n\n    /**\n     * Releases memory used by the incremental buffer and other additional\n     * resources. If you plan to use the instance again, use reset instead.\n     */\n    SparkMD5.prototype.destroy = function () {\n        delete this._hash;\n        delete this._buff;\n        delete this._length;\n    };\n\n    /**\n     * Finish the final calculation based on the tail.\n     *\n     * @param {Array}  tail   The tail (will be modified)\n     * @param {Number} length The length of the remaining buffer\n     */\n    SparkMD5.prototype._finish = function (tail, length) {\n        var i = length,\n            tmp,\n            lo,\n            hi;\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(this._hash, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Do the final computation based on the tail and length\n        // Beware that the final length may not fit in 32 bits so we take care of that\n        tmp = this._length * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n        md5cycle(this._hash, tail);\n    };\n\n    /**\n     * Performs the md5 hash on a string.\n     * A conversion will be applied if utf8 string is detected.\n     *\n     * @param {String}  str The string\n     * @param {Boolean} [raw] True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hash = function (str, raw) {\n        // Converts the string to utf8 bytes if necessary\n        // Then compute it using the binary function\n        return SparkMD5.hashBinary(toUtf8(str), raw);\n    };\n\n    /**\n     * Performs the md5 hash on a binary string.\n     *\n     * @param {String}  content The binary string\n     * @param {Boolean} [raw]     True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hashBinary = function (content, raw) {\n        var hash = md51(content),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation for array buffers.\n     *\n     * Use this class to perform an incremental md5 ONLY for array buffers.\n     */\n    SparkMD5.ArrayBuffer = function () {\n        // call reset to init the instance\n        this.reset();\n    };\n\n    /**\n     * Appends an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array to be appended\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n        var buff = concatenateArrayBuffers(this._buff.buffer, arr, true),\n            length = buff.length,\n            i;\n\n        this._length += arr.byteLength;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk_array(buff.subarray(i - 64, i)));\n        }\n\n        this._buff = (i - 64) < length ? new Uint8Array(buff.buffer.slice(i - 64)) : new Uint8Array(0);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            i,\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.reset = function () {\n        this._buff = new Uint8Array(0);\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.ArrayBuffer.prototype.getState = function () {\n        var state = SparkMD5.prototype.getState.call(this);\n\n        // Convert buffer to a string\n        state.buff = arrayBuffer2Utf8Str(state.buff);\n\n        return state;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.setState = function (state) {\n        // Convert string to buffer\n        state.buff = utf8Str2ArrayBuffer(state.buff, true);\n\n        return SparkMD5.prototype.setState.call(this, state);\n    };\n\n    SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n    SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n    /**\n     * Performs the md5 hash on an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array buffer\n     * @param {Boolean}     [raw] True to get the raw string, false to get the hex one\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n        var hash = md51_array(new Uint8Array(arr)),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    return SparkMD5;\n}));\n","(function() {\n\n    var debug = false;\n\n    var root = this;\n\n    var EXIF = function(obj) {\n        if (obj instanceof EXIF) return obj;\n        if (!(this instanceof EXIF)) return new EXIF(obj);\n        this.EXIFwrapped = obj;\n    };\n\n    if (typeof exports !== 'undefined') {\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = EXIF;\n        }\n        exports.EXIF = EXIF;\n    } else {\n        root.EXIF = EXIF;\n    }\n\n    var ExifTags = EXIF.Tags = {\n\n        // version tags\n        0x9000 : \"ExifVersion\",             // EXIF version\n        0xA000 : \"FlashpixVersion\",         // Flashpix format version\n\n        // colorspace tags\n        0xA001 : \"ColorSpace\",              // Color space information tag\n\n        // image configuration\n        0xA002 : \"PixelXDimension\",         // Valid width of meaningful image\n        0xA003 : \"PixelYDimension\",         // Valid height of meaningful image\n        0x9101 : \"ComponentsConfiguration\", // Information about channels\n        0x9102 : \"CompressedBitsPerPixel\",  // Compressed bits per pixel\n\n        // user information\n        0x927C : \"MakerNote\",               // Any desired information written by the manufacturer\n        0x9286 : \"UserComment\",             // Comments by user\n\n        // related file\n        0xA004 : \"RelatedSoundFile\",        // Name of related sound file\n\n        // date and time\n        0x9003 : \"DateTimeOriginal\",        // Date and time when the original image was generated\n        0x9004 : \"DateTimeDigitized\",       // Date and time when the image was stored digitally\n        0x9290 : \"SubsecTime\",              // Fractions of seconds for DateTime\n        0x9291 : \"SubsecTimeOriginal\",      // Fractions of seconds for DateTimeOriginal\n        0x9292 : \"SubsecTimeDigitized\",     // Fractions of seconds for DateTimeDigitized\n\n        // picture-taking conditions\n        0x829A : \"ExposureTime\",            // Exposure time (in seconds)\n        0x829D : \"FNumber\",                 // F number\n        0x8822 : \"ExposureProgram\",         // Exposure program\n        0x8824 : \"SpectralSensitivity\",     // Spectral sensitivity\n        0x8827 : \"ISOSpeedRatings\",         // ISO speed rating\n        0x8828 : \"OECF\",                    // Optoelectric conversion factor\n        0x9201 : \"ShutterSpeedValue\",       // Shutter speed\n        0x9202 : \"ApertureValue\",           // Lens aperture\n        0x9203 : \"BrightnessValue\",         // Value of brightness\n        0x9204 : \"ExposureBias\",            // Exposure bias\n        0x9205 : \"MaxApertureValue\",        // Smallest F number of lens\n        0x9206 : \"SubjectDistance\",         // Distance to subject in meters\n        0x9207 : \"MeteringMode\",            // Metering mode\n        0x9208 : \"LightSource\",             // Kind of light source\n        0x9209 : \"Flash\",                   // Flash status\n        0x9214 : \"SubjectArea\",             // Location and area of main subject\n        0x920A : \"FocalLength\",             // Focal length of the lens in mm\n        0xA20B : \"FlashEnergy\",             // Strobe energy in BCPS\n        0xA20C : \"SpatialFrequencyResponse\",    //\n        0xA20E : \"FocalPlaneXResolution\",   // Number of pixels in width direction per FocalPlaneResolutionUnit\n        0xA20F : \"FocalPlaneYResolution\",   // Number of pixels in height direction per FocalPlaneResolutionUnit\n        0xA210 : \"FocalPlaneResolutionUnit\",    // Unit for measuring FocalPlaneXResolution and FocalPlaneYResolution\n        0xA214 : \"SubjectLocation\",         // Location of subject in image\n        0xA215 : \"ExposureIndex\",           // Exposure index selected on camera\n        0xA217 : \"SensingMethod\",           // Image sensor type\n        0xA300 : \"FileSource\",              // Image source (3 == DSC)\n        0xA301 : \"SceneType\",               // Scene type (1 == directly photographed)\n        0xA302 : \"CFAPattern\",              // Color filter array geometric pattern\n        0xA401 : \"CustomRendered\",          // Special processing\n        0xA402 : \"ExposureMode\",            // Exposure mode\n        0xA403 : \"WhiteBalance\",            // 1 = auto white balance, 2 = manual\n        0xA404 : \"DigitalZoomRation\",       // Digital zoom ratio\n        0xA405 : \"FocalLengthIn35mmFilm\",   // Equivalent foacl length assuming 35mm film camera (in mm)\n        0xA406 : \"SceneCaptureType\",        // Type of scene\n        0xA407 : \"GainControl\",             // Degree of overall image gain adjustment\n        0xA408 : \"Contrast\",                // Direction of contrast processing applied by camera\n        0xA409 : \"Saturation\",              // Direction of saturation processing applied by camera\n        0xA40A : \"Sharpness\",               // Direction of sharpness processing applied by camera\n        0xA40B : \"DeviceSettingDescription\",    //\n        0xA40C : \"SubjectDistanceRange\",    // Distance to subject\n\n        // other tags\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0xA420 : \"ImageUniqueID\"            // Identifier assigned uniquely to each image\n    };\n\n    var TiffTags = EXIF.TiffTags = {\n        0x0100 : \"ImageWidth\",\n        0x0101 : \"ImageHeight\",\n        0x8769 : \"ExifIFDPointer\",\n        0x8825 : \"GPSInfoIFDPointer\",\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0x0102 : \"BitsPerSample\",\n        0x0103 : \"Compression\",\n        0x0106 : \"PhotometricInterpretation\",\n        0x0112 : \"Orientation\",\n        0x0115 : \"SamplesPerPixel\",\n        0x011C : \"PlanarConfiguration\",\n        0x0212 : \"YCbCrSubSampling\",\n        0x0213 : \"YCbCrPositioning\",\n        0x011A : \"XResolution\",\n        0x011B : \"YResolution\",\n        0x0128 : \"ResolutionUnit\",\n        0x0111 : \"StripOffsets\",\n        0x0116 : \"RowsPerStrip\",\n        0x0117 : \"StripByteCounts\",\n        0x0201 : \"JPEGInterchangeFormat\",\n        0x0202 : \"JPEGInterchangeFormatLength\",\n        0x012D : \"TransferFunction\",\n        0x013E : \"WhitePoint\",\n        0x013F : \"PrimaryChromaticities\",\n        0x0211 : \"YCbCrCoefficients\",\n        0x0214 : \"ReferenceBlackWhite\",\n        0x0132 : \"DateTime\",\n        0x010E : \"ImageDescription\",\n        0x010F : \"Make\",\n        0x0110 : \"Model\",\n        0x0131 : \"Software\",\n        0x013B : \"Artist\",\n        0x8298 : \"Copyright\"\n    };\n\n    var GPSTags = EXIF.GPSTags = {\n        0x0000 : \"GPSVersionID\",\n        0x0001 : \"GPSLatitudeRef\",\n        0x0002 : \"GPSLatitude\",\n        0x0003 : \"GPSLongitudeRef\",\n        0x0004 : \"GPSLongitude\",\n        0x0005 : \"GPSAltitudeRef\",\n        0x0006 : \"GPSAltitude\",\n        0x0007 : \"GPSTimeStamp\",\n        0x0008 : \"GPSSatellites\",\n        0x0009 : \"GPSStatus\",\n        0x000A : \"GPSMeasureMode\",\n        0x000B : \"GPSDOP\",\n        0x000C : \"GPSSpeedRef\",\n        0x000D : \"GPSSpeed\",\n        0x000E : \"GPSTrackRef\",\n        0x000F : \"GPSTrack\",\n        0x0010 : \"GPSImgDirectionRef\",\n        0x0011 : \"GPSImgDirection\",\n        0x0012 : \"GPSMapDatum\",\n        0x0013 : \"GPSDestLatitudeRef\",\n        0x0014 : \"GPSDestLatitude\",\n        0x0015 : \"GPSDestLongitudeRef\",\n        0x0016 : \"GPSDestLongitude\",\n        0x0017 : \"GPSDestBearingRef\",\n        0x0018 : \"GPSDestBearing\",\n        0x0019 : \"GPSDestDistanceRef\",\n        0x001A : \"GPSDestDistance\",\n        0x001B : \"GPSProcessingMethod\",\n        0x001C : \"GPSAreaInformation\",\n        0x001D : \"GPSDateStamp\",\n        0x001E : \"GPSDifferential\"\n    };\n\n     // EXIF 2.3 Spec\n    var IFD1Tags = EXIF.IFD1Tags = {\n        0x0100: \"ImageWidth\",\n        0x0101: \"ImageHeight\",\n        0x0102: \"BitsPerSample\",\n        0x0103: \"Compression\",\n        0x0106: \"PhotometricInterpretation\",\n        0x0111: \"StripOffsets\",\n        0x0112: \"Orientation\",\n        0x0115: \"SamplesPerPixel\",\n        0x0116: \"RowsPerStrip\",\n        0x0117: \"StripByteCounts\",\n        0x011A: \"XResolution\",\n        0x011B: \"YResolution\",\n        0x011C: \"PlanarConfiguration\",\n        0x0128: \"ResolutionUnit\",\n        0x0201: \"JpegIFOffset\",    // When image format is JPEG, this value show offset to JPEG data stored.(aka \"ThumbnailOffset\" or \"JPEGInterchangeFormat\")\n        0x0202: \"JpegIFByteCount\", // When image format is JPEG, this value shows data size of JPEG image (aka \"ThumbnailLength\" or \"JPEGInterchangeFormatLength\")\n        0x0211: \"YCbCrCoefficients\",\n        0x0212: \"YCbCrSubSampling\",\n        0x0213: \"YCbCrPositioning\",\n        0x0214: \"ReferenceBlackWhite\"\n    };\n\n    var StringValues = EXIF.StringValues = {\n        ExposureProgram : {\n            0 : \"Not defined\",\n            1 : \"Manual\",\n            2 : \"Normal program\",\n            3 : \"Aperture priority\",\n            4 : \"Shutter priority\",\n            5 : \"Creative program\",\n            6 : \"Action program\",\n            7 : \"Portrait mode\",\n            8 : \"Landscape mode\"\n        },\n        MeteringMode : {\n            0 : \"Unknown\",\n            1 : \"Average\",\n            2 : \"CenterWeightedAverage\",\n            3 : \"Spot\",\n            4 : \"MultiSpot\",\n            5 : \"Pattern\",\n            6 : \"Partial\",\n            255 : \"Other\"\n        },\n        LightSource : {\n            0 : \"Unknown\",\n            1 : \"Daylight\",\n            2 : \"Fluorescent\",\n            3 : \"Tungsten (incandescent light)\",\n            4 : \"Flash\",\n            9 : \"Fine weather\",\n            10 : \"Cloudy weather\",\n            11 : \"Shade\",\n            12 : \"Daylight fluorescent (D 5700 - 7100K)\",\n            13 : \"Day white fluorescent (N 4600 - 5400K)\",\n            14 : \"Cool white fluorescent (W 3900 - 4500K)\",\n            15 : \"White fluorescent (WW 3200 - 3700K)\",\n            17 : \"Standard light A\",\n            18 : \"Standard light B\",\n            19 : \"Standard light C\",\n            20 : \"D55\",\n            21 : \"D65\",\n            22 : \"D75\",\n            23 : \"D50\",\n            24 : \"ISO studio tungsten\",\n            255 : \"Other\"\n        },\n        Flash : {\n            0x0000 : \"Flash did not fire\",\n            0x0001 : \"Flash fired\",\n            0x0005 : \"Strobe return light not detected\",\n            0x0007 : \"Strobe return light detected\",\n            0x0009 : \"Flash fired, compulsory flash mode\",\n            0x000D : \"Flash fired, compulsory flash mode, return light not detected\",\n            0x000F : \"Flash fired, compulsory flash mode, return light detected\",\n            0x0010 : \"Flash did not fire, compulsory flash mode\",\n            0x0018 : \"Flash did not fire, auto mode\",\n            0x0019 : \"Flash fired, auto mode\",\n            0x001D : \"Flash fired, auto mode, return light not detected\",\n            0x001F : \"Flash fired, auto mode, return light detected\",\n            0x0020 : \"No flash function\",\n            0x0041 : \"Flash fired, red-eye reduction mode\",\n            0x0045 : \"Flash fired, red-eye reduction mode, return light not detected\",\n            0x0047 : \"Flash fired, red-eye reduction mode, return light detected\",\n            0x0049 : \"Flash fired, compulsory flash mode, red-eye reduction mode\",\n            0x004D : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",\n            0x004F : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",\n            0x0059 : \"Flash fired, auto mode, red-eye reduction mode\",\n            0x005D : \"Flash fired, auto mode, return light not detected, red-eye reduction mode\",\n            0x005F : \"Flash fired, auto mode, return light detected, red-eye reduction mode\"\n        },\n        SensingMethod : {\n            1 : \"Not defined\",\n            2 : \"One-chip color area sensor\",\n            3 : \"Two-chip color area sensor\",\n            4 : \"Three-chip color area sensor\",\n            5 : \"Color sequential area sensor\",\n            7 : \"Trilinear sensor\",\n            8 : \"Color sequential linear sensor\"\n        },\n        SceneCaptureType : {\n            0 : \"Standard\",\n            1 : \"Landscape\",\n            2 : \"Portrait\",\n            3 : \"Night scene\"\n        },\n        SceneType : {\n            1 : \"Directly photographed\"\n        },\n        CustomRendered : {\n            0 : \"Normal process\",\n            1 : \"Custom process\"\n        },\n        WhiteBalance : {\n            0 : \"Auto white balance\",\n            1 : \"Manual white balance\"\n        },\n        GainControl : {\n            0 : \"None\",\n            1 : \"Low gain up\",\n            2 : \"High gain up\",\n            3 : \"Low gain down\",\n            4 : \"High gain down\"\n        },\n        Contrast : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        Saturation : {\n            0 : \"Normal\",\n            1 : \"Low saturation\",\n            2 : \"High saturation\"\n        },\n        Sharpness : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        SubjectDistanceRange : {\n            0 : \"Unknown\",\n            1 : \"Macro\",\n            2 : \"Close view\",\n            3 : \"Distant view\"\n        },\n        FileSource : {\n            3 : \"DSC\"\n        },\n\n        Components : {\n            0 : \"\",\n            1 : \"Y\",\n            2 : \"Cb\",\n            3 : \"Cr\",\n            4 : \"R\",\n            5 : \"G\",\n            6 : \"B\"\n        }\n    };\n\n    function addEvent(element, event, handler) {\n        if (element.addEventListener) {\n            element.addEventListener(event, handler, false);\n        } else if (element.attachEvent) {\n            element.attachEvent(\"on\" + event, handler);\n        }\n    }\n\n    function imageHasData(img) {\n        return !!(img.exifdata);\n    }\n\n\n    function base64ToArrayBuffer(base64, contentType) {\n        contentType = contentType || base64.match(/^data\\:([^\\;]+)\\;base64,/mi)[1] || ''; // e.g. 'data:image/jpeg;base64,...' => 'image/jpeg'\n        base64 = base64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n        var binary = atob(base64);\n        var len = binary.length;\n        var buffer = new ArrayBuffer(len);\n        var view = new Uint8Array(buffer);\n        for (var i = 0; i < len; i++) {\n            view[i] = binary.charCodeAt(i);\n        }\n        return buffer;\n    }\n\n    function objectURLToBlob(url, callback) {\n        var http = new XMLHttpRequest();\n        http.open(\"GET\", url, true);\n        http.responseType = \"blob\";\n        http.onload = function(e) {\n            if (this.status == 200 || this.status === 0) {\n                callback(this.response);\n            }\n        };\n        http.send();\n    }\n\n    function getImageData(img, callback) {\n        function handleBinaryFile(binFile) {\n            var data = findEXIFinJPEG(binFile);\n            img.exifdata = data || {};\n            var iptcdata = findIPTCinJPEG(binFile);\n            img.iptcdata = iptcdata || {};\n            if (EXIF.isXmpEnabled) {\n               var xmpdata= findXMPinJPEG(binFile);\n               img.xmpdata = xmpdata || {};               \n            }\n            if (callback) {\n                callback.call(img);\n            }\n        }\n\n        if (img.src) {\n            if (/^data\\:/i.test(img.src)) { // Data URI\n                var arrayBuffer = base64ToArrayBuffer(img.src);\n                handleBinaryFile(arrayBuffer);\n\n            } else if (/^blob\\:/i.test(img.src)) { // Object URL\n                var fileReader = new FileReader();\n                fileReader.onload = function(e) {\n                    handleBinaryFile(e.target.result);\n                };\n                objectURLToBlob(img.src, function (blob) {\n                    fileReader.readAsArrayBuffer(blob);\n                });\n            } else {\n                var http = new XMLHttpRequest();\n                http.onload = function() {\n                    if (this.status == 200 || this.status === 0) {\n                        handleBinaryFile(http.response);\n                    } else {\n                        throw \"Could not load image\";\n                    }\n                    http = null;\n                };\n                http.open(\"GET\", img.src, true);\n                http.responseType = \"arraybuffer\";\n                http.send(null);\n            }\n        } else if (self.FileReader && (img instanceof self.Blob || img instanceof self.File)) {\n            var fileReader = new FileReader();\n            fileReader.onload = function(e) {\n                if (debug) console.log(\"Got file of length \" + e.target.result.byteLength);\n                handleBinaryFile(e.target.result);\n            };\n\n            fileReader.readAsArrayBuffer(img);\n        }\n    }\n\n    function findEXIFinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            marker;\n\n        while (offset < length) {\n            if (dataView.getUint8(offset) != 0xFF) {\n                if (debug) console.log(\"Not a valid marker at offset \" + offset + \", found: \" + dataView.getUint8(offset));\n                return false; // not a valid marker, something is wrong\n            }\n\n            marker = dataView.getUint8(offset + 1);\n            if (debug) console.log(marker);\n\n            // we could implement handling for other markers here,\n            // but we're only looking for 0xFFE1 for EXIF data\n\n            if (marker == 225) {\n                if (debug) console.log(\"Found 0xFFE1 marker\");\n\n                return readEXIFData(dataView, offset + 4, dataView.getUint16(offset + 2) - 2);\n\n                // offset += 2 + file.getShortAt(offset+2, true);\n\n            } else {\n                offset += 2 + dataView.getUint16(offset+2);\n            }\n\n        }\n\n    }\n\n    function findIPTCinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength;\n\n\n        var isFieldSegmentStart = function(dataView, offset){\n            return (\n                dataView.getUint8(offset) === 0x38 &&\n                dataView.getUint8(offset+1) === 0x42 &&\n                dataView.getUint8(offset+2) === 0x49 &&\n                dataView.getUint8(offset+3) === 0x4D &&\n                dataView.getUint8(offset+4) === 0x04 &&\n                dataView.getUint8(offset+5) === 0x04\n            );\n        };\n\n        while (offset < length) {\n\n            if ( isFieldSegmentStart(dataView, offset )){\n\n                // Get the length of the name header (which is padded to an even number of bytes)\n                var nameHeaderLength = dataView.getUint8(offset+7);\n                if(nameHeaderLength % 2 !== 0) nameHeaderLength += 1;\n                // Check for pre photoshop 6 format\n                if(nameHeaderLength === 0) {\n                    // Always 4\n                    nameHeaderLength = 4;\n                }\n\n                var startOffset = offset + 8 + nameHeaderLength;\n                var sectionLength = dataView.getUint16(offset + 6 + nameHeaderLength);\n\n                return readIPTCData(file, startOffset, sectionLength);\n\n                break;\n\n            }\n\n\n            // Not the marker, continue searching\n            offset++;\n\n        }\n\n    }\n    var IptcFieldMap = {\n        0x78 : 'caption',\n        0x6E : 'credit',\n        0x19 : 'keywords',\n        0x37 : 'dateCreated',\n        0x50 : 'byline',\n        0x55 : 'bylineTitle',\n        0x7A : 'captionWriter',\n        0x69 : 'headline',\n        0x74 : 'copyright',\n        0x0F : 'category'\n    };\n    function readIPTCData(file, startOffset, sectionLength){\n        var dataView = new DataView(file);\n        var data = {};\n        var fieldValue, fieldName, dataSize, segmentType, segmentSize;\n        var segmentStartPos = startOffset;\n        while(segmentStartPos < startOffset+sectionLength) {\n            if(dataView.getUint8(segmentStartPos) === 0x1C && dataView.getUint8(segmentStartPos+1) === 0x02){\n                segmentType = dataView.getUint8(segmentStartPos+2);\n                if(segmentType in IptcFieldMap) {\n                    dataSize = dataView.getInt16(segmentStartPos+3);\n                    segmentSize = dataSize + 5;\n                    fieldName = IptcFieldMap[segmentType];\n                    fieldValue = getStringFromDB(dataView, segmentStartPos+5, dataSize);\n                    // Check if we already stored a value with this name\n                    if(data.hasOwnProperty(fieldName)) {\n                        // Value already stored with this name, create multivalue field\n                        if(data[fieldName] instanceof Array) {\n                            data[fieldName].push(fieldValue);\n                        }\n                        else {\n                            data[fieldName] = [data[fieldName], fieldValue];\n                        }\n                    }\n                    else {\n                        data[fieldName] = fieldValue;\n                    }\n                }\n\n            }\n            segmentStartPos++;\n        }\n        return data;\n    }\n\n\n\n    function readTags(file, tiffStart, dirStart, strings, bigEnd) {\n        var entries = file.getUint16(dirStart, !bigEnd),\n            tags = {},\n            entryOffset, tag,\n            i;\n\n        for (i=0;i<entries;i++) {\n            entryOffset = dirStart + i*12 + 2;\n            tag = strings[file.getUint16(entryOffset, !bigEnd)];\n            if (!tag && debug) console.log(\"Unknown tag: \" + file.getUint16(entryOffset, !bigEnd));\n            tags[tag] = readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd);\n        }\n        return tags;\n    }\n\n\n    function readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd) {\n        var type = file.getUint16(entryOffset+2, !bigEnd),\n            numValues = file.getUint32(entryOffset+4, !bigEnd),\n            valueOffset = file.getUint32(entryOffset+8, !bigEnd) + tiffStart,\n            offset,\n            vals, val, n,\n            numerator, denominator;\n\n        switch (type) {\n            case 1: // byte, 8-bit unsigned int\n            case 7: // undefined, 8-bit byte, value depending on field\n                if (numValues == 1) {\n                    return file.getUint8(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint8(offset + n);\n                    }\n                    return vals;\n                }\n\n            case 2: // ascii, 8-bit byte\n                offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                return getStringFromDB(file, offset, numValues-1);\n\n            case 3: // short, 16 bit int\n                if (numValues == 1) {\n                    return file.getUint16(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 2 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint16(offset + 2*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 4: // long, 32 bit int\n                if (numValues == 1) {\n                    return file.getUint32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 5:    // rational = two long values, first is numerator, second is denominator\n                if (numValues == 1) {\n                    numerator = file.getUint32(valueOffset, !bigEnd);\n                    denominator = file.getUint32(valueOffset+4, !bigEnd);\n                    val = new Number(numerator / denominator);\n                    val.numerator = numerator;\n                    val.denominator = denominator;\n                    return val;\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        numerator = file.getUint32(valueOffset + 8*n, !bigEnd);\n                        denominator = file.getUint32(valueOffset+4 + 8*n, !bigEnd);\n                        vals[n] = new Number(numerator / denominator);\n                        vals[n].numerator = numerator;\n                        vals[n].denominator = denominator;\n                    }\n                    return vals;\n                }\n\n            case 9: // slong, 32 bit signed int\n                if (numValues == 1) {\n                    return file.getInt32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 10: // signed rational, two slongs, first is numerator, second is denominator\n                if (numValues == 1) {\n                    return file.getInt32(valueOffset, !bigEnd) / file.getInt32(valueOffset+4, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 8*n, !bigEnd) / file.getInt32(valueOffset+4 + 8*n, !bigEnd);\n                    }\n                    return vals;\n                }\n        }\n    }\n\n    /**\n    * Given an IFD (Image File Directory) start offset\n    * returns an offset to next IFD or 0 if it's the last IFD.\n    */\n    function getNextIFDOffset(dataView, dirStart, bigEnd){\n        //the first 2bytes means the number of directory entries contains in this IFD\n        var entries = dataView.getUint16(dirStart, !bigEnd);\n\n        // After last directory entry, there is a 4bytes of data,\n        // it means an offset to next IFD.\n        // If its value is '0x00000000', it means this is the last IFD and there is no linked IFD.\n\n        return dataView.getUint32(dirStart + 2 + entries * 12, !bigEnd); // each entry is 12 bytes long\n    }\n\n    function readThumbnailImage(dataView, tiffStart, firstIFDOffset, bigEnd){\n        // get the IFD1 offset\n        var IFD1OffsetPointer = getNextIFDOffset(dataView, tiffStart+firstIFDOffset, bigEnd);\n\n        if (!IFD1OffsetPointer) {\n            // console.log('******** IFD1Offset is empty, image thumb not found ********');\n            return {};\n        }\n        else if (IFD1OffsetPointer > dataView.byteLength) { // this should not happen\n            // console.log('******** IFD1Offset is outside the bounds of the DataView ********');\n            return {};\n        }\n        // console.log('*******  thumbnail IFD offset (IFD1) is: %s', IFD1OffsetPointer);\n\n        var thumbTags = readTags(dataView, tiffStart, tiffStart + IFD1OffsetPointer, IFD1Tags, bigEnd)\n\n        // EXIF 2.3 specification for JPEG format thumbnail\n\n        // If the value of Compression(0x0103) Tag in IFD1 is '6', thumbnail image format is JPEG.\n        // Most of Exif image uses JPEG format for thumbnail. In that case, you can get offset of thumbnail\n        // by JpegIFOffset(0x0201) Tag in IFD1, size of thumbnail by JpegIFByteCount(0x0202) Tag.\n        // Data format is ordinary JPEG format, starts from 0xFFD8 and ends by 0xFFD9. It seems that\n        // JPEG format and 160x120pixels of size are recommended thumbnail format for Exif2.1 or later.\n\n        if (thumbTags['Compression']) {\n            // console.log('Thumbnail image found!');\n\n            switch (thumbTags['Compression']) {\n                case 6:\n                    // console.log('Thumbnail image format is JPEG');\n                    if (thumbTags.JpegIFOffset && thumbTags.JpegIFByteCount) {\n                    // extract the thumbnail\n                        var tOffset = tiffStart + thumbTags.JpegIFOffset;\n                        var tLength = thumbTags.JpegIFByteCount;\n                        thumbTags['blob'] = new Blob([new Uint8Array(dataView.buffer, tOffset, tLength)], {\n                            type: 'image/jpeg'\n                        });\n                    }\n                break;\n\n            case 1:\n                console.log(\"Thumbnail image format is TIFF, which is not implemented.\");\n                break;\n            default:\n                console.log(\"Unknown thumbnail image format '%s'\", thumbTags['Compression']);\n            }\n        }\n        else if (thumbTags['PhotometricInterpretation'] == 2) {\n            console.log(\"Thumbnail image format is RGB, which is not implemented.\");\n        }\n        return thumbTags;\n    }\n\n    function getStringFromDB(buffer, start, length) {\n        var outstr = \"\";\n        for (n = start; n < start+length; n++) {\n            outstr += String.fromCharCode(buffer.getUint8(n));\n        }\n        return outstr;\n    }\n\n    function readEXIFData(file, start) {\n        if (getStringFromDB(file, start, 4) != \"Exif\") {\n            if (debug) console.log(\"Not valid EXIF data! \" + getStringFromDB(file, start, 4));\n            return false;\n        }\n\n        var bigEnd,\n            tags, tag,\n            exifData, gpsData,\n            tiffOffset = start + 6;\n\n        // test for TIFF validity and endianness\n        if (file.getUint16(tiffOffset) == 0x4949) {\n            bigEnd = false;\n        } else if (file.getUint16(tiffOffset) == 0x4D4D) {\n            bigEnd = true;\n        } else {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x4949 or 0x4D4D)\");\n            return false;\n        }\n\n        if (file.getUint16(tiffOffset+2, !bigEnd) != 0x002A) {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x002A)\");\n            return false;\n        }\n\n        var firstIFDOffset = file.getUint32(tiffOffset+4, !bigEnd);\n\n        if (firstIFDOffset < 0x00000008) {\n            if (debug) console.log(\"Not valid TIFF data! (First offset less than 8)\", file.getUint32(tiffOffset+4, !bigEnd));\n            return false;\n        }\n\n        tags = readTags(file, tiffOffset, tiffOffset + firstIFDOffset, TiffTags, bigEnd);\n\n        if (tags.ExifIFDPointer) {\n            exifData = readTags(file, tiffOffset, tiffOffset + tags.ExifIFDPointer, ExifTags, bigEnd);\n            for (tag in exifData) {\n                switch (tag) {\n                    case \"LightSource\" :\n                    case \"Flash\" :\n                    case \"MeteringMode\" :\n                    case \"ExposureProgram\" :\n                    case \"SensingMethod\" :\n                    case \"SceneCaptureType\" :\n                    case \"SceneType\" :\n                    case \"CustomRendered\" :\n                    case \"WhiteBalance\" :\n                    case \"GainControl\" :\n                    case \"Contrast\" :\n                    case \"Saturation\" :\n                    case \"Sharpness\" :\n                    case \"SubjectDistanceRange\" :\n                    case \"FileSource\" :\n                        exifData[tag] = StringValues[tag][exifData[tag]];\n                        break;\n\n                    case \"ExifVersion\" :\n                    case \"FlashpixVersion\" :\n                        exifData[tag] = String.fromCharCode(exifData[tag][0], exifData[tag][1], exifData[tag][2], exifData[tag][3]);\n                        break;\n\n                    case \"ComponentsConfiguration\" :\n                        exifData[tag] =\n                            StringValues.Components[exifData[tag][0]] +\n                            StringValues.Components[exifData[tag][1]] +\n                            StringValues.Components[exifData[tag][2]] +\n                            StringValues.Components[exifData[tag][3]];\n                        break;\n                }\n                tags[tag] = exifData[tag];\n            }\n        }\n\n        if (tags.GPSInfoIFDPointer) {\n            gpsData = readTags(file, tiffOffset, tiffOffset + tags.GPSInfoIFDPointer, GPSTags, bigEnd);\n            for (tag in gpsData) {\n                switch (tag) {\n                    case \"GPSVersionID\" :\n                        gpsData[tag] = gpsData[tag][0] +\n                            \".\" + gpsData[tag][1] +\n                            \".\" + gpsData[tag][2] +\n                            \".\" + gpsData[tag][3];\n                        break;\n                }\n                tags[tag] = gpsData[tag];\n            }\n        }\n\n        // extract thumbnail\n        tags['thumbnail'] = readThumbnailImage(file, tiffOffset, firstIFDOffset, bigEnd);\n\n        return tags;\n    }\n\n   function findXMPinJPEG(file) {\n\n        if (!('DOMParser' in self)) {\n            // console.warn('XML parsing not supported without DOMParser');\n            return;\n        }\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n           if (debug) console.log(\"Not a valid JPEG\");\n           return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            dom = new DOMParser();\n\n        while (offset < (length-4)) {\n            if (getStringFromDB(dataView, offset, 4) == \"http\") {\n                var startOffset = offset - 1;\n                var sectionLength = dataView.getUint16(offset - 2) - 1;\n                var xmpString = getStringFromDB(dataView, startOffset, sectionLength)\n                var xmpEndIndex = xmpString.indexOf('xmpmeta>') + 8;\n                xmpString = xmpString.substring( xmpString.indexOf( '<x:xmpmeta' ), xmpEndIndex );\n\n                var indexOfXmp = xmpString.indexOf('x:xmpmeta') + 10\n                //Many custom written programs embed xmp/xml without any namespace. Following are some of them.\n                //Without these namespaces, XML is thought to be invalid by parsers\n                xmpString = xmpString.slice(0, indexOfXmp)\n                            + 'xmlns:Iptc4xmpCore=\"http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/\" '\n                            + 'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" '\n                            + 'xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\" '\n                            + 'xmlns:plus=\"http://schemas.android.com/apk/lib/com.google.android.gms.plus\" '\n                            + 'xmlns:ext=\"http://www.gettyimages.com/xsltExtension/1.0\" '\n                            + 'xmlns:exif=\"http://ns.adobe.com/exif/1.0/\" '\n                            + 'xmlns:stEvt=\"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#\" '\n                            + 'xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\" '\n                            + 'xmlns:crs=\"http://ns.adobe.com/camera-raw-settings/1.0/\" '\n                            + 'xmlns:xapGImg=\"http://ns.adobe.com/xap/1.0/g/img/\" '\n                            + 'xmlns:Iptc4xmpExt=\"http://iptc.org/std/Iptc4xmpExt/2008-02-29/\" '\n                            + xmpString.slice(indexOfXmp)\n\n                var domDocument = dom.parseFromString( xmpString, 'text/xml' );\n                return xml2Object(domDocument);\n            } else{\n             offset++;\n            }\n        }\n    }\n\n    function xml2json(xml) {\n        var json = {};\n      \n        if (xml.nodeType == 1) { // element node\n          if (xml.attributes.length > 0) {\n            json['@attributes'] = {};\n            for (var j = 0; j < xml.attributes.length; j++) {\n              var attribute = xml.attributes.item(j);\n              json['@attributes'][attribute.nodeName] = attribute.nodeValue;\n            }\n          }\n        } else if (xml.nodeType == 3) { // text node\n          return xml.nodeValue;\n        }\n      \n        // deal with children\n        if (xml.hasChildNodes()) {\n          for(var i = 0; i < xml.childNodes.length; i++) {\n            var child = xml.childNodes.item(i);\n            var nodeName = child.nodeName;\n            if (json[nodeName] == null) {\n              json[nodeName] = xml2json(child);\n            } else {\n              if (json[nodeName].push == null) {\n                var old = json[nodeName];\n                json[nodeName] = [];\n                json[nodeName].push(old);\n              }\n              json[nodeName].push(xml2json(child));\n            }\n          }\n        }\n        \n        return json;\n    }\n\n    function xml2Object(xml) {\n        try {\n            var obj = {};\n            if (xml.children.length > 0) {\n              for (var i = 0; i < xml.children.length; i++) {\n                var item = xml.children.item(i);\n                var attributes = item.attributes;\n                for(var idx in attributes) {\n                    var itemAtt = attributes[idx];\n                    var dataKey = itemAtt.nodeName;\n                    var dataValue = itemAtt.nodeValue;\n\n                    if(dataKey !== undefined) {\n                        obj[dataKey] = dataValue;\n                    }\n                }\n                var nodeName = item.nodeName;\n\n                if (typeof (obj[nodeName]) == \"undefined\") {\n                  obj[nodeName] = xml2json(item);\n                } else {\n                  if (typeof (obj[nodeName].push) == \"undefined\") {\n                    var old = obj[nodeName];\n\n                    obj[nodeName] = [];\n                    obj[nodeName].push(old);\n                  }\n                  obj[nodeName].push(xml2json(item));\n                }\n              }\n            } else {\n              obj = xml.textContent;\n            }\n            return obj;\n          } catch (e) {\n              console.log(e.message);\n          }\n    }\n\n    EXIF.enableXmp = function() {\n        EXIF.isXmpEnabled = true;\n    }\n\n    EXIF.disableXmp = function() {\n        EXIF.isXmpEnabled = false;\n    }\n\n    EXIF.getData = function(img, callback) {\n        if (((self.Image && img instanceof self.Image)\n            || (self.HTMLImageElement && img instanceof self.HTMLImageElement))\n            && !img.complete)\n            return false;\n\n        if (!imageHasData(img)) {\n            getImageData(img, callback);\n        } else {\n            if (callback) {\n                callback.call(img);\n            }\n        }\n        return true;\n    }\n\n    EXIF.getTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.exifdata[tag];\n    }\n    \n    EXIF.getIptcTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.iptcdata[tag];\n    }\n\n    EXIF.getAllTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.exifdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n    \n    EXIF.getAllIptcTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.iptcdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n\n    EXIF.pretty = function(img) {\n        if (!imageHasData(img)) return \"\";\n        var a,\n            data = img.exifdata,\n            strPretty = \"\";\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                if (typeof data[a] == \"object\") {\n                    if (data[a] instanceof Number) {\n                        strPretty += a + \" : \" + data[a] + \" [\" + data[a].numerator + \"/\" + data[a].denominator + \"]\\r\\n\";\n                    } else {\n                        strPretty += a + \" : [\" + data[a].length + \" values]\\r\\n\";\n                    }\n                } else {\n                    strPretty += a + \" : \" + data[a] + \"\\r\\n\";\n                }\n            }\n        }\n        return strPretty;\n    }\n\n    EXIF.readFromBinaryFile = function(file) {\n        return findEXIFinJPEG(file);\n    }\n\n    if (typeof define === 'function' && define.amd) {\n        define('exif-js', [], function() {\n            return EXIF;\n        });\n    }\n}.call(this));\n\n","/* eslint-disable */\nexport function utf8Encode(argString) {\n    // http://kevin.vanzonneveld.net\n    // +   original by: Webtoolkit.info (http://www.webtoolkit.info/)\n    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // +   improved by: sowberry\n    // +    tweaked by: Jack\n    // +   bugfixed by: Onno Marsman\n    // +   improved by: Yves Sucaet\n    // +   bugfixed by: Onno Marsman\n    // +   bugfixed by: Ulrich\n    // +   bugfixed by: Rafal Kukawski\n    // +   improved by: kirilloid\n    // +   bugfixed by: kirilloid\n    // *     example 1: this.utf8Encode('Kevin van Zonneveld')\n    // *     returns 1: 'Kevin van Zonneveld'\n    if (argString === null || typeof argString === 'undefined') {\n        return '';\n    }\n    var string = argString + ''; // .replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n')\n    var utftext = '', start, end, stringl = 0;\n    start = end = 0;\n    stringl = string.length;\n    for (var n = 0; n < stringl; n++) {\n        var c1 = string.charCodeAt(n);\n        var enc = null;\n        if (c1 < 128) {\n            end++;\n        }\n        else if (c1 > 127 && c1 < 2048) {\n            enc = String.fromCharCode((c1 >> 6) | 192, (c1 & 63) | 128);\n        }\n        else if ((c1 & 0xf800 ^ 0xd800) > 0) {\n            enc = String.fromCharCode((c1 >> 12) | 224, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128);\n        }\n        else {\n            // surrogate pairs\n            if ((c1 & 0xfc00 ^ 0xd800) > 0) {\n                throw new RangeError('Unmatched trail surrogate at ' + n);\n            }\n            var c2 = string.charCodeAt(++n);\n            if ((c2 & 0xfc00 ^ 0xdc00) > 0) {\n                throw new RangeError('Unmatched lead surrogate at ' + (n - 1));\n            }\n            c1 = ((c1 & 0x3ff) << 10) + (c2 & 0x3ff) + 0x10000;\n            enc = String.fromCharCode((c1 >> 18) | 240, ((c1 >> 12) & 63) | 128, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128);\n        }\n        if (enc !== null) {\n            if (end > start) {\n                utftext += string.slice(start, end);\n            }\n            utftext += enc;\n            start = end = n + 1;\n        }\n    }\n    if (end > start) {\n        utftext += string.slice(start, stringl);\n    }\n    return utftext;\n}\nexport function base64Encode(data) {\n    // http://kevin.vanzonneveld.net\n    // +   original by: Tyler Akins (http://rumkin.com)\n    // +   improved by: Bayron Guevara\n    // +   improved by: Thunder.m\n    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // +   bugfixed by: Pellentesque Malesuada\n    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // -    depends on: this.utf8Encode\n    // *     example 1: this.base64Encode('Kevin van Zonneveld')\n    // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='\n    // mozilla has this native\n    // - but breaks in 2.0.0.12!\n    // if (typeof this.window['atob'] == 'function') {\n    //    return atob(data)\n    // }\n    var b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n    var o1, o2, o3, h1, h2, h3, h4, bits, i = 0, ac = 0, enc = '', tmp_arr = [];\n    if (!data) {\n        return data;\n    }\n    data = utf8Encode(data + '');\n    do {\n        // pack three octets into four hexets\n        o1 = data.charCodeAt(i++);\n        o2 = data.charCodeAt(i++);\n        o3 = data.charCodeAt(i++);\n        bits = (o1 << 16) | (o2 << 8) | o3;\n        h1 = (bits >> 18) & 0x3f;\n        h2 = (bits >> 12) & 0x3f;\n        h3 = (bits >> 6) & 0x3f;\n        h4 = bits & 0x3f;\n        // use hexets to index into b64, and append result to encoded string\n        tmp_arr[ac++] =\n            b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);\n    } while (i < data.length);\n    enc = tmp_arr.join('');\n    switch (data.length % 3) {\n        case 1:\n            enc = enc.slice(0, -2) + '==';\n            break;\n        case 2:\n            enc = enc.slice(0, -1) + '=';\n            break;\n    }\n    return enc;\n}\nexport function base64Decode(data) {\n    // http://kevin.vanzonneveld.net\n    // +   original by: Tyler Akins (http://rumkin.com)\n    // +   improved by: Thunder.m\n    // +      input by: Aman Gupta\n    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // +   bugfixed by: Onno Marsman\n    // +   bugfixed by: Pellentesque Malesuada\n    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // +      input by: Brett Zamir (http://brett-zamir.me)\n    // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==')\n    // *     returns 1: 'Kevin van Zonneveld'\n    // mozilla has this native\n    // - but breaks in 2.0.0.12!\n    // if (typeof this.window['atob'] == 'function') {\n    //    return atob(data)\n    // }\n    var b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n    var o1, o2, o3, h1, h2, h3, h4, bits, i = 0, ac = 0, dec = '', tmp_arr = [];\n    if (!data) {\n        return data;\n    }\n    data += '';\n    do { // unpack four hexets into three octets using index points in b64\n        h1 = b64.indexOf(data.charAt(i++));\n        h2 = b64.indexOf(data.charAt(i++));\n        h3 = b64.indexOf(data.charAt(i++));\n        h4 = b64.indexOf(data.charAt(i++));\n        bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;\n        o1 = bits >> 16 & 0xff;\n        o2 = bits >> 8 & 0xff;\n        o3 = bits & 0xff;\n        if (h3 === 64) {\n            tmp_arr[ac++] = String.fromCharCode(o1);\n        }\n        else if (h4 === 64) {\n            tmp_arr[ac++] = String.fromCharCode(o1, o2);\n        }\n        else {\n            tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);\n        }\n    } while (i < data.length);\n    dec = tmp_arr.join('');\n    return dec;\n}\nexport function urlSafeBase64Encode(v) {\n    v = base64Encode(v);\n    return v.replace(/\\//g, '_').replace(/\\+/g, '-');\n}\nexport function urlSafeBase64Decode(v) {\n    v = v.replace(/_/g, '/').replace(/-/g, '+');\n    return base64Decode(v);\n}\n//# sourceMappingURL=base64.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport SparkMD5 from 'spark-md5';\nimport { urlSafeBase64Decode } from './base64';\nexport var MB = Math.pow(1024, 2);\n// 文件分块\nexport function getChunks(file, blockSize) {\n    var chunkByteSize = blockSize * MB; // 转换为字节\n    // 如果 chunkByteSize 比文件大，则直接取文件的大小\n    if (chunkByteSize > file.size) {\n        chunkByteSize = file.size;\n    }\n    else {\n        // 因为最多 10000 chunk，所以如果 chunkSize 不符合则把每片 chunk 大小扩大两倍\n        while (file.size > chunkByteSize * 10000) {\n            chunkByteSize *= 2;\n        }\n    }\n    var chunks = [];\n    var count = Math.ceil(file.size / chunkByteSize);\n    for (var i = 0; i < count; i++) {\n        var chunk = file.slice(chunkByteSize * i, i === count - 1 ? file.size : chunkByteSize * (i + 1));\n        chunks.push(chunk);\n    }\n    return chunks;\n}\nexport function isMetaDataValid(params) {\n    return Object.keys(params).every(function (key) { return key.indexOf('x-qn-meta-') === 0; });\n}\nexport function isCustomVarsValid(params) {\n    return Object.keys(params).every(function (key) { return key.indexOf('x:') === 0; });\n}\nexport function sum(list) {\n    return list.reduce(function (data, loaded) { return data + loaded; }, 0);\n}\nexport function setLocalFileInfo(localKey, info) {\n    try {\n        localStorage.setItem(localKey, JSON.stringify(info));\n    }\n    catch (err) {\n        if (window.console && window.console.warn) {\n            // eslint-disable-next-line no-console\n            console.warn('setLocalFileInfo failed');\n        }\n    }\n}\nexport function createLocalKey(name, key, size) {\n    var localKey = key == null ? '_' : \"_key_\" + key + \"_\";\n    return \"qiniu_js_sdk_upload_file_name_\" + name + localKey + \"size_\" + size;\n}\nexport function removeLocalFileInfo(localKey) {\n    try {\n        localStorage.removeItem(localKey);\n    }\n    catch (err) {\n        if (window.console && window.console.warn) {\n            // eslint-disable-next-line no-console\n            console.warn('removeLocalFileInfo failed');\n        }\n    }\n}\nexport function getLocalFileInfo(localKey) {\n    try {\n        var localInfo = localStorage.getItem(localKey);\n        return localInfo ? JSON.parse(localInfo) : null;\n    }\n    catch (err) {\n        if (window.console && window.console.warn) {\n            // eslint-disable-next-line no-console\n            console.warn('getLocalFileInfo failed');\n        }\n        return null;\n    }\n}\nexport function getAuthHeaders(token) {\n    var auth = 'UpToken ' + token;\n    return { Authorization: auth };\n}\nexport function getHeadersForChunkUpload(token) {\n    var header = getAuthHeaders(token);\n    return __assign({ 'content-type': 'application/octet-stream' }, header);\n}\nexport function getHeadersForMkFile(token) {\n    var header = getAuthHeaders(token);\n    return __assign({ 'content-type': 'application/json' }, header);\n}\nexport function createXHR() {\n    if (window.XMLHttpRequest) {\n        return new XMLHttpRequest();\n    }\n    return window.ActiveXObject('Microsoft.XMLHTTP');\n}\nexport function computeMd5(data) {\n    return __awaiter(this, void 0, void 0, function () {\n        var buffer, spark;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, readAsArrayBuffer(data)];\n                case 1:\n                    buffer = _a.sent();\n                    spark = new SparkMD5.ArrayBuffer();\n                    spark.append(buffer);\n                    return [2 /*return*/, spark.end()];\n            }\n        });\n    });\n}\nexport function readAsArrayBuffer(data) {\n    return new Promise(function (resolve, reject) {\n        var reader = new FileReader();\n        // evt 类型目前存在问题 https://github.com/Microsoft/TypeScript/issues/4163\n        reader.onload = function (evt) {\n            if (evt.target) {\n                var body = evt.target.result;\n                resolve(body);\n            }\n            else {\n                reject(new Error('progress event target is undefined'));\n            }\n        };\n        reader.onerror = function () {\n            reject(new Error('fileReader read failed'));\n        };\n        reader.readAsArrayBuffer(data);\n    });\n}\nexport function request(url, options) {\n    return new Promise(function (resolve, reject) {\n        var xhr = createXHR();\n        xhr.open(options.method, url);\n        if (options.onCreate) {\n            options.onCreate(xhr);\n        }\n        if (options.headers) {\n            var headers_1 = options.headers;\n            Object.keys(headers_1).forEach(function (k) {\n                xhr.setRequestHeader(k, headers_1[k]);\n            });\n        }\n        xhr.upload.addEventListener('progress', function (evt) {\n            if (evt.lengthComputable && options.onProgress) {\n                options.onProgress({\n                    loaded: evt.loaded,\n                    total: evt.total\n                });\n            }\n        });\n        xhr.onreadystatechange = function () {\n            var responseText = xhr.responseText;\n            if (xhr.readyState !== 4) {\n                return;\n            }\n            var reqId = xhr.getResponseHeader('x-reqId') || '';\n            if (xhr.status !== 200) {\n                var message = \"xhr request failed, code: \" + xhr.status;\n                if (responseText) {\n                    message += \" response: \" + responseText;\n                }\n                reject({\n                    code: xhr.status,\n                    message: message,\n                    reqId: reqId,\n                    isRequestError: true\n                });\n                return;\n            }\n            try {\n                resolve({\n                    data: JSON.parse(responseText),\n                    reqId: reqId\n                });\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n        xhr.send(options.body);\n    });\n}\nexport function getPortFromUrl(url) {\n    if (url && url.match) {\n        var groups = url.match(/(^https?)/);\n        if (!groups) {\n            return '';\n        }\n        var type = groups[1];\n        groups = url.match(/^https?:\\/\\/([^:^/]*):(\\d*)/);\n        if (groups) {\n            return groups[2];\n        }\n        if (type === 'http') {\n            return '80';\n        }\n        return '443';\n    }\n    return '';\n}\nexport function getDomainFromUrl(url) {\n    if (url && url.match) {\n        var groups = url.match(/^https?:\\/\\/([^:^/]*)/);\n        return groups ? groups[1] : '';\n    }\n    return '';\n}\nexport function getPutPolicy(token) {\n    var segments = token.split(':');\n    // token 构造的差异参考：https://github.com/qbox/product/blob/master/kodo/auths/UpToken.md#admin-uptoken-authorization\n    var ak = segments.length > 3 ? segments[1] : segments[0];\n    var putPolicy = JSON.parse(urlSafeBase64Decode(segments[segments.length - 1]));\n    return {\n        ak: ak,\n        bucket: putPolicy.scope.split(':')[0]\n    };\n}\nexport function createObjectURL(file) {\n    var URL = window.URL || window.webkitURL || window.mozURL;\n    return URL.createObjectURL(file);\n}\nexport function getTransform(image, orientation) {\n    var width = image.width, height = image.height;\n    switch (orientation) {\n        case 1:\n            // default\n            return {\n                width: width,\n                height: height,\n                matrix: [1, 0, 0, 1, 0, 0]\n            };\n        case 2:\n            // horizontal flip\n            return {\n                width: width,\n                height: height,\n                matrix: [-1, 0, 0, 1, width, 0]\n            };\n        case 3:\n            // 180° rotated\n            return {\n                width: width,\n                height: height,\n                matrix: [-1, 0, 0, -1, width, height]\n            };\n        case 4:\n            // vertical flip\n            return {\n                width: width,\n                height: height,\n                matrix: [1, 0, 0, -1, 0, height]\n            };\n        case 5:\n            // vertical flip + -90° rotated\n            return {\n                width: height,\n                height: width,\n                matrix: [0, 1, 1, 0, 0, 0]\n            };\n        case 6:\n            // -90° rotated\n            return {\n                width: height,\n                height: width,\n                matrix: [0, 1, -1, 0, height, 0]\n            };\n        case 7:\n            // horizontal flip + -90° rotate\n            return {\n                width: height,\n                height: width,\n                matrix: [0, -1, -1, 0, height, width]\n            };\n        case 8:\n            // 90° rotated\n            return {\n                width: height,\n                height: width,\n                matrix: [0, -1, 1, 0, 0, width]\n            };\n        default:\n            throw new Error(\"orientation \" + orientation + \" is unavailable\");\n    }\n}\n//# sourceMappingURL=utils.js.map","import { createXHR } from './utils';\nvar StatisticsLogger = /** @class */ (function () {\n    function StatisticsLogger() {\n    }\n    StatisticsLogger.prototype.log = function (info, token) {\n        var logString = Object.values(info).join(',');\n        this.send(logString, token, 0);\n    };\n    StatisticsLogger.prototype.send = function (logString, token, retryCount) {\n        var _this = this;\n        var xhr = createXHR();\n        xhr.open('POST', 'https://uplog.qbox.me/log/3');\n        xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n        xhr.setRequestHeader('Authorization', 'UpToken ' + token);\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4 && xhr.status !== 200 && ++retryCount <= 3) {\n                _this.send(logString, token, retryCount);\n            }\n        };\n        xhr.send(logString);\n    };\n    return StatisticsLogger;\n}());\nexport default StatisticsLogger;\n//# sourceMappingURL=statisticsLog.js.map","var _a;\n/** 上传区域 */\nexport var region = {\n    z0: 'z0',\n    z1: 'z1',\n    z2: 'z2',\n    na0: 'na0',\n    as0: 'as0'\n};\n/** 上传区域对应的 host */\nexport var regionUphostMap = (_a = {},\n    _a[region.z0] = {\n        srcUphost: 'up.qiniup.com',\n        cdnUphost: 'upload.qiniup.com'\n    },\n    _a[region.z1] = {\n        srcUphost: 'up-z1.qiniup.com',\n        cdnUphost: 'upload-z1.qiniup.com'\n    },\n    _a[region.z2] = {\n        srcUphost: 'up-z2.qiniup.com',\n        cdnUphost: 'upload-z2.qiniup.com'\n    },\n    _a[region.na0] = {\n        srcUphost: 'up-na0.qiniup.com',\n        cdnUphost: 'upload-na0.qiniup.com'\n    },\n    _a[region.as0] = {\n        srcUphost: 'up-as0.qiniup.com',\n        cdnUphost: 'upload-as0.qiniup.com'\n    },\n    _a);\n//# sourceMappingURL=config.js.map","var Pool = /** @class */ (function () {\n    function Pool(runTask, limit) {\n        this.runTask = runTask;\n        this.limit = limit;\n        this.queue = [];\n        this.processing = [];\n    }\n    Pool.prototype.enqueue = function (task) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.queue.push({\n                task: task,\n                resolve: resolve,\n                reject: reject\n            });\n            _this.check();\n        });\n    };\n    Pool.prototype.run = function (item) {\n        var _this = this;\n        this.queue = this.queue.filter(function (v) { return v !== item; });\n        this.processing.push(item);\n        this.runTask(item.task).then(function () {\n            _this.processing = _this.processing.filter(function (v) { return v !== item; });\n            item.resolve();\n            _this.check();\n        }, function (err) { return item.reject(err); });\n    };\n    Pool.prototype.check = function () {\n        var _this = this;\n        var processingNum = this.processing.length;\n        var availableNum = this.limit - processingNum;\n        this.queue.slice(0, availableNum).forEach(function (item) {\n            _this.run(item);\n        });\n    };\n    return Pool;\n}());\nexport { Pool };\n//# sourceMappingURL=pool.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport * as utils from './utils';\nimport { regionUphostMap } from './config';\nimport { urlSafeBase64Encode } from './base64';\nexport function getUpHosts(token, protocol) {\n    return __awaiter(this, void 0, void 0, function () {\n        var putPolicy, url;\n        return __generator(this, function (_a) {\n            putPolicy = utils.getPutPolicy(token);\n            url = protocol + '//api.qiniu.com/v2/query?ak=' + putPolicy.ak + '&bucket=' + putPolicy.bucket;\n            return [2 /*return*/, utils.request(url, { method: 'GET' })];\n        });\n    });\n}\n/** 获取上传url */\nexport function getUploadUrl(config, token) {\n    return __awaiter(this, void 0, void 0, function () {\n        var protocol, upHosts, host, res, hosts;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    protocol = config.upprotocol;\n                    if (config.uphost) {\n                        return [2 /*return*/, protocol + \"//\" + config.uphost];\n                    }\n                    if (config.region) {\n                        upHosts = regionUphostMap[config.region];\n                        host = config.useCdnDomain ? upHosts.cdnUphost : upHosts.srcUphost;\n                        return [2 /*return*/, protocol + \"//\" + host];\n                    }\n                    return [4 /*yield*/, getUpHosts(token, protocol)];\n                case 1:\n                    res = _a.sent();\n                    hosts = res.data.up.acc.main;\n                    return [2 /*return*/, protocol + \"//\" + hosts[0]];\n            }\n        });\n    });\n}\n/**\n * @param bucket 空间名\n * @param key 目标文件名\n * @param uploadInfo 上传信息\n */\nfunction getBaseUrl(bucket, key, uploadInfo) {\n    var url = uploadInfo.url, id = uploadInfo.id;\n    return url + \"/buckets/\" + bucket + \"/objects/\" + (key != null ? urlSafeBase64Encode(key) : '~') + \"/uploads/\" + id;\n}\n/**\n * @param token 上传鉴权凭证\n * @param bucket 上传空间\n * @param key 目标文件名\n * @param uploadUrl 上传地址\n */\nexport function initUploadParts(token, bucket, key, uploadUrl) {\n    var url = uploadUrl + \"/buckets/\" + bucket + \"/objects/\" + (key != null ? urlSafeBase64Encode(key) : '~') + \"/uploads\";\n    return utils.request(url, {\n        method: 'POST',\n        headers: utils.getAuthHeaders(token)\n    });\n}\n/**\n * @param token 上传鉴权凭证\n * @param index 当前 chunk 的索引\n * @param uploadInfo 上传信息\n * @param options 请求参数\n */\nexport function uploadChunk(token, key, index, uploadInfo, options) {\n    var bucket = utils.getPutPolicy(token).bucket;\n    var url = getBaseUrl(bucket, key, uploadInfo) + (\"/\" + index);\n    return utils.request(url, __assign(__assign({}, options), { method: 'PUT', headers: utils.getHeadersForChunkUpload(token) }));\n}\n/**\n * @param token 上传鉴权凭证\n * @param key 目标文件名\n * @param uploadInfo 上传信息\n * @param options 请求参数\n */\nexport function uploadComplete(token, key, uploadInfo, options) {\n    var bucket = utils.getPutPolicy(token).bucket;\n    var url = getBaseUrl(bucket, key, uploadInfo);\n    return utils.request(url, __assign(__assign({}, options), { method: 'POST', headers: utils.getHeadersForMkFile(token) }));\n}\n/**\n * @param token 上传鉴权凭证\n * @param key 目标文件名\n * @param uploadInfo 上传信息\n */\nexport function deleteUploadedChunks(token, key, uploadinfo) {\n    var bucket = utils.getPutPolicy(token).bucket;\n    var url = getBaseUrl(bucket, key, uploadinfo);\n    return utils.request(url, {\n        method: 'DELETE',\n        headers: utils.getAuthHeaders(token)\n    });\n}\n//# sourceMappingURL=api.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport * as utils from '../utils';\nimport { getUploadUrl } from '../api';\nexport var DEFAULT_CHUNK_SIZE = 4; // 单位 MB\nvar GB = Math.pow(1024, 3);\nvar Base = /** @class */ (function () {\n    function Base(options, handlers, statisticsLogger) {\n        this.statisticsLogger = statisticsLogger;\n        this.xhrList = [];\n        this.aborted = false;\n        this.retryCount = 0;\n        this.config = __assign({ useCdnDomain: true, disableStatisticsReport: false, retryCount: 3, checkByMD5: false, uphost: '', upprotocol: 'https:', forceDirect: false, chunkSize: DEFAULT_CHUNK_SIZE, concurrentRequestLimit: 3 }, options.config);\n        this.putExtra = __assign({ fname: '' }, options.putExtra);\n        this.file = options.file;\n        this.key = options.key;\n        this.token = options.token;\n        this.onData = handlers.onData;\n        this.onError = handlers.onError;\n        this.onComplete = handlers.onComplete;\n        try {\n            this.bucket = utils.getPutPolicy(this.token).bucket;\n        }\n        catch (e) {\n            this.onError(e);\n        }\n    }\n    Base.prototype.putFile = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var err, err, err, _a, result, err_1, reqId, code, needRetry, notReachRetryCount;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.aborted = false;\n                        if (!this.putExtra.fname) {\n                            this.putExtra.fname = this.file.name;\n                        }\n                        if (this.file.size > 10000 * GB) {\n                            err = new Error('file size exceed maximum value 10000G');\n                            this.onError(err);\n                            throw err;\n                        }\n                        if (this.putExtra.customVars) {\n                            if (!utils.isCustomVarsValid(this.putExtra.customVars)) {\n                                err = new Error('customVars key should start width x:');\n                                this.onError(err);\n                                throw err;\n                            }\n                        }\n                        if (this.putExtra.metadata) {\n                            if (!utils.isMetaDataValid(this.putExtra.metadata)) {\n                                err = new Error('metadata key should start with x-qn-meta-');\n                                this.onError(err);\n                                throw err;\n                            }\n                        }\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, , 5]);\n                        _a = this;\n                        return [4 /*yield*/, getUploadUrl(this.config, this.token)];\n                    case 2:\n                        _a.uploadUrl = _b.sent();\n                        this.uploadAt = new Date().getTime();\n                        return [4 /*yield*/, this.run()];\n                    case 3:\n                        result = _b.sent();\n                        this.onComplete(result.data);\n                        if (!this.config.disableStatisticsReport) {\n                            this.sendLog(result.reqId, 200);\n                        }\n                        return [2 /*return*/, result];\n                    case 4:\n                        err_1 = _b.sent();\n                        this.clear();\n                        if (err_1.isRequestError && !this.config.disableStatisticsReport) {\n                            reqId = this.aborted ? '' : err_1.reqId;\n                            code = this.aborted ? -2 : err_1.code;\n                            this.sendLog(reqId, code);\n                        }\n                        needRetry = err_1.isRequestError && err_1.code === 0 && !this.aborted;\n                        notReachRetryCount = ++this.retryCount <= this.config.retryCount;\n                        // 以下条件满足其中之一则会进行重新上传：\n                        // 1. 满足 needRetry 的条件且 retryCount 不为 0\n                        // 2. uploadId 无效时在 resume 里会清除本地数据，并且这里触发重新上传\n                        if (needRetry && notReachRetryCount || err_1.code === 612) {\n                            return [2 /*return*/, this.putFile()];\n                        }\n                        this.onError(err_1);\n                        throw err_1;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Base.prototype.clear = function () {\n        this.xhrList.forEach(function (xhr) { return xhr.abort(); });\n        this.xhrList = [];\n    };\n    Base.prototype.stop = function () {\n        this.clear();\n        this.aborted = true;\n    };\n    Base.prototype.addXhr = function (xhr) {\n        this.xhrList.push(xhr);\n    };\n    Base.prototype.sendLog = function (reqId, code) {\n        this.statisticsLogger.log({\n            code: code,\n            reqId: reqId,\n            host: utils.getDomainFromUrl(this.uploadUrl),\n            remoteIp: '',\n            port: utils.getPortFromUrl(this.uploadUrl),\n            duration: (new Date().getTime() - this.uploadAt) / 1000,\n            time: Math.floor(this.uploadAt / 1000),\n            bytesSent: this.progress ? this.progress.total.loaded : 0,\n            upType: 'jssdk-h5',\n            size: this.file.size\n        }, this.token);\n    };\n    Base.prototype.getProgressInfoItem = function (loaded, size) {\n        return {\n            loaded: loaded,\n            size: size,\n            percent: loaded / size * 100\n        };\n    };\n    return Base;\n}());\nexport default Base;\n//# sourceMappingURL=base.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport * as utils from '../utils';\nimport { Pool } from '../pool';\nimport { uploadChunk, uploadComplete, initUploadParts } from '../api';\nimport Base from './base';\n/** 是否为正整数 */\nfunction isPositiveInteger(n) {\n    var re = /^[1-9]\\d*$/;\n    return re.test(String(n));\n}\nvar Resume = /** @class */ (function (_super) {\n    __extends(Resume, _super);\n    function Resume() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Resume.prototype.run = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var pool, uploadChunks, result;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.config.chunkSize || !isPositiveInteger(this.config.chunkSize)) {\n                            throw new Error('chunkSize must be a positive integer');\n                        }\n                        if (this.config.chunkSize > 1024) {\n                            throw new Error('chunkSize maximum value is 1024');\n                        }\n                        return [4 /*yield*/, this.initBeforeUploadChunks()];\n                    case 1:\n                        _a.sent();\n                        pool = new Pool(function (chunkInfo) { return _this.uploadChunk(chunkInfo); }, this.config.concurrentRequestLimit);\n                        uploadChunks = this.chunks.map(function (chunk, index) { return pool.enqueue({ chunk: chunk, index: index }); });\n                        result = Promise.all(uploadChunks).then(function () { return _this.mkFileReq(); });\n                        result.then(function () {\n                            utils.removeLocalFileInfo(_this.getLocalKey());\n                        }, function (err) {\n                            // uploadId 无效，上传参数有误（多由于本地存储信息的 uploadId 失效\n                            if (err.code === 612 || err.code === 400) {\n                                utils.removeLocalFileInfo(_this.getLocalKey());\n                            }\n                        });\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    Resume.prototype.uploadChunk = function (chunkInfo) {\n        return __awaiter(this, void 0, void 0, function () {\n            var index, chunk, info, shouldCheckMD5, reuseSaved, md5, onProgress, requestOptions, response;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        index = chunkInfo.index, chunk = chunkInfo.chunk;\n                        info = this.uploadedList[index];\n                        shouldCheckMD5 = this.config.checkByMD5;\n                        reuseSaved = function () {\n                            _this.updateChunkProgress(chunk.size, index);\n                        };\n                        if (info && !shouldCheckMD5) {\n                            reuseSaved();\n                            return [2 /*return*/];\n                        }\n                        return [4 /*yield*/, utils.computeMd5(chunk)];\n                    case 1:\n                        md5 = _a.sent();\n                        if (info && md5 === info.md5) {\n                            reuseSaved();\n                            return [2 /*return*/];\n                        }\n                        onProgress = function (data) {\n                            _this.updateChunkProgress(data.loaded, index);\n                        };\n                        requestOptions = {\n                            body: chunk,\n                            onProgress: onProgress,\n                            onCreate: function (xhr) { return _this.addXhr(xhr); }\n                        };\n                        return [4 /*yield*/, uploadChunk(this.token, this.key, chunkInfo.index + 1, this.getUploadInfo(), requestOptions)\n                            // 在某些浏览器环境下，xhr 的 progress 事件无法被触发，progress 为 null，这里在每次分片上传完成后都手动更新下 progress\n                        ];\n                    case 2:\n                        response = _a.sent();\n                        // 在某些浏览器环境下，xhr 的 progress 事件无法被触发，progress 为 null，这里在每次分片上传完成后都手动更新下 progress\n                        onProgress({\n                            loaded: chunk.size,\n                            total: chunk.size\n                        });\n                        this.uploadedList[index] = {\n                            etag: response.data.etag,\n                            md5: response.data.md5,\n                            size: chunk.size\n                        };\n                        utils.setLocalFileInfo(this.getLocalKey(), {\n                            id: this.uploadId,\n                            data: this.uploadedList\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Resume.prototype.mkFileReq = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, result;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        data = __assign(__assign(__assign({ parts: this.uploadedList.map(function (value, index) { return ({\n                                etag: value.etag,\n                                partNumber: index + 1\n                            }); }), fname: this.putExtra.fname }, this.putExtra.mimeType && { mimeType: this.putExtra.mimeType }), this.putExtra.customVars && { customVars: this.putExtra.customVars }), this.putExtra.metadata && { metadata: this.putExtra.metadata });\n                        return [4 /*yield*/, uploadComplete(this.token, this.key, this.getUploadInfo(), {\n                                onCreate: function (xhr) { return _this.addXhr(xhr); },\n                                body: JSON.stringify(data)\n                            })];\n                    case 1:\n                        result = _a.sent();\n                        this.updateMkFileProgress(1);\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    Resume.prototype.initBeforeUploadChunks = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var localInfo, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        localInfo = utils.getLocalFileInfo(this.getLocalKey());\n                        if (!!localInfo) return [3 /*break*/, 2];\n                        // 防止本地信息已被破坏，初始化时 clear 一下\n                        utils.removeLocalFileInfo(this.getLocalKey());\n                        return [4 /*yield*/, initUploadParts(this.token, this.bucket, this.key, this.uploadUrl)];\n                    case 1:\n                        res = _a.sent();\n                        this.uploadId = res.data.uploadId;\n                        this.uploadedList = [];\n                        return [3 /*break*/, 3];\n                    case 2:\n                        this.uploadId = localInfo.id;\n                        this.uploadedList = localInfo.data;\n                        _a.label = 3;\n                    case 3:\n                        this.chunks = utils.getChunks(this.file, this.config.chunkSize);\n                        this.loaded = {\n                            mkFileProgress: 0,\n                            chunks: this.chunks.map(function (_) { return 0; })\n                        };\n                        this.notifyResumeProgress();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Resume.prototype.getUploadInfo = function () {\n        return {\n            id: this.uploadId,\n            url: this.uploadUrl\n        };\n    };\n    Resume.prototype.getLocalKey = function () {\n        return utils.createLocalKey(this.file.name, this.key, this.file.size);\n    };\n    Resume.prototype.updateChunkProgress = function (loaded, index) {\n        this.loaded.chunks[index] = loaded;\n        this.notifyResumeProgress();\n    };\n    Resume.prototype.updateMkFileProgress = function (progress) {\n        this.loaded.mkFileProgress = progress;\n        this.notifyResumeProgress();\n    };\n    Resume.prototype.notifyResumeProgress = function () {\n        var _this = this;\n        this.progress = {\n            total: this.getProgressInfoItem(utils.sum(this.loaded.chunks) + this.loaded.mkFileProgress, this.file.size + 1 // 防止在 complete 未调用的时候进度显示 100%\n            ),\n            chunks: this.chunks.map(function (chunk, index) { return (_this.getProgressInfoItem(_this.loaded.chunks[index], chunk.size)); }),\n            uploadInfo: {\n                id: this.uploadId,\n                url: this.uploadUrl\n            }\n        };\n        this.onData(this.progress);\n    };\n    return Resume;\n}(Base));\nexport default Resume;\n//# sourceMappingURL=resume.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { request } from '../utils';\nimport Base from './base';\nvar Direct = /** @class */ (function (_super) {\n    __extends(Direct, _super);\n    function Direct() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Direct.prototype.run = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var formData, customVars_1, result;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        formData = new FormData();\n                        formData.append('file', this.file);\n                        formData.append('token', this.token);\n                        if (this.key != null) {\n                            formData.append('key', this.key);\n                        }\n                        formData.append('fname', this.putExtra.fname);\n                        if (this.putExtra.customVars) {\n                            customVars_1 = this.putExtra.customVars;\n                            Object.keys(customVars_1).forEach(function (key) { return formData.append(key, customVars_1[key].toString()); });\n                        }\n                        return [4 /*yield*/, request(this.uploadUrl, {\n                                method: 'POST',\n                                body: formData,\n                                onProgress: function (data) {\n                                    _this.updateDirectProgress(data.loaded, data.total);\n                                },\n                                onCreate: function (xhr) { return _this.addXhr(xhr); }\n                            })];\n                    case 1:\n                        result = _a.sent();\n                        this.finishDirectProgress();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    Direct.prototype.updateDirectProgress = function (loaded, total) {\n        // 当请求未完成时可能进度会达到100，所以total + 1来防止这种情况出现\n        this.progress = { total: this.getProgressInfoItem(loaded, total + 1) };\n        this.onData(this.progress);\n    };\n    Direct.prototype.finishDirectProgress = function () {\n        // 在某些浏览器环境下，xhr 的 progress 事件无法被触发，progress 为 null，这里 fake 下\n        if (!this.progress) {\n            this.progress = { total: this.getProgressInfoItem(this.file.size, this.file.size) };\n            this.onData(this.progress);\n            return;\n        }\n        var total = this.progress.total;\n        this.progress = { total: this.getProgressInfoItem(total.loaded + 1, total.size) };\n        this.onData(this.progress);\n    };\n    return Direct;\n}(Base));\nexport default Direct;\n//# sourceMappingURL=direct.js.map","import Resume from './resume';\nimport Direct from './direct';\nimport { MB } from '../utils';\nexport * from './base';\nexport * from './resume';\nexport default function createUploadManager(options, handlers, statisticsLogger) {\n    if (options.config && options.config.forceDirect) {\n        return new Direct(options, handlers, statisticsLogger);\n    }\n    return options.file.size > 4 * MB\n        ? new Resume(options, handlers, statisticsLogger)\n        : new Direct(options, handlers, statisticsLogger);\n}\n//# sourceMappingURL=index.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n/** 表示可清理的资源，比如 Observable 的执行 */\nvar Subscription = /** @class */ (function () {\n    function Subscription() {\n        /** 用来标示该 Subscription 是否被取消订阅的标示位 */\n        this.closed = false;\n    }\n    /** 取消 observer 的订阅 */\n    Subscription.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.closed = true;\n        if (this._unsubscribe) {\n            this._unsubscribe();\n        }\n    };\n    /** 添加一个 tear down 在该 Subscription 的 unsubscribe() 期间调用 */\n    Subscription.prototype.add = function (teardown) {\n        this._unsubscribe = teardown;\n    };\n    return Subscription;\n}());\n/**\n * 实现 Observer 接口并且继承 Subscription 类，Observer 是消费 Observable 值的公有 API\n * 所有 Observers 都转化成了 Subscriber，以便提供类似 Subscription 的能力，比如 unsubscribe\n*/\nvar Subscriber = /** @class */ (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (observerOrNext && typeof observerOrNext === 'object') {\n            _this.destination = observerOrNext;\n        }\n        else {\n            _this.destination = __assign(__assign(__assign({}, observerOrNext && { next: observerOrNext }), error && { error: error }), complete && { complete: complete });\n        }\n        return _this;\n    }\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped && this.destination.next) {\n            this.destination.next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped && this.destination.error) {\n            this.isStopped = true;\n            this.destination.error(err);\n        }\n    };\n    Subscriber.prototype.complete = function (result) {\n        if (!this.isStopped && this.destination.complete) {\n            this.isStopped = true;\n            this.destination.complete(result);\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\n/** 可观察对象，当前的上传事件的集合 */\nvar Observable = /** @class */ (function () {\n    function Observable(_subscribe) {\n        this._subscribe = _subscribe;\n    }\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var sink = new Subscriber(observerOrNext, error, complete);\n        sink.add(this._subscribe(sink));\n        return sink;\n    };\n    return Observable;\n}());\nexport { Observable };\n//# sourceMappingURL=observable.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport { EXIF } from 'exif-js';\nimport { createObjectURL, getTransform } from './utils';\nvar mimeTypes = {\n    PNG: 'image/png',\n    JPEG: 'image/jpeg',\n    WEBP: 'image/webp',\n    BMP: 'image/bmp'\n};\nvar maxSteps = 4;\nvar scaleFactor = Math.log(2);\nvar supportMimeTypes = Object.keys(mimeTypes).map(function (type) { return mimeTypes[type]; });\nvar defaultType = mimeTypes.JPEG;\nfunction isSupportedType(type) {\n    return supportMimeTypes.includes(type);\n}\nvar Compress = /** @class */ (function () {\n    function Compress(file, config) {\n        this.file = file;\n        this.config = config;\n        this.config = __assign({ quality: 0.92, noCompressIfLarger: false }, this.config);\n    }\n    Compress.prototype.process = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var srcDimension, originImage, canvas, scale, scaleCanvas, distBlob;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.outputType = this.file.type;\n                        srcDimension = {};\n                        if (!isSupportedType(this.file.type)) {\n                            throw new Error(\"unsupported file type: \" + this.file.type);\n                        }\n                        return [4 /*yield*/, this.getOriginImage()];\n                    case 1:\n                        originImage = _a.sent();\n                        return [4 /*yield*/, this.getCanvas(originImage)];\n                    case 2:\n                        canvas = _a.sent();\n                        scale = 1;\n                        if (this.config.maxWidth) {\n                            scale = Math.min(1, this.config.maxWidth / canvas.width);\n                        }\n                        if (this.config.maxHeight) {\n                            scale = Math.min(1, scale, this.config.maxHeight / canvas.height);\n                        }\n                        srcDimension.width = canvas.width;\n                        srcDimension.height = canvas.height;\n                        return [4 /*yield*/, this.doScale(canvas, scale)];\n                    case 3:\n                        scaleCanvas = _a.sent();\n                        distBlob = this.toBlob(scaleCanvas);\n                        if (distBlob.size > this.file.size && this.config.noCompressIfLarger) {\n                            return [2 /*return*/, {\n                                    dist: this.file,\n                                    width: srcDimension.width,\n                                    height: srcDimension.height\n                                }];\n                        }\n                        return [2 /*return*/, {\n                                dist: distBlob,\n                                width: scaleCanvas.width,\n                                height: scaleCanvas.height\n                            }];\n                }\n            });\n        });\n    };\n    Compress.prototype.clear = function (ctx, width, height) {\n        // jpeg 没有 alpha 通道，透明区间会被填充成黑色，这里把透明区间填充为白色\n        if (this.outputType === defaultType) {\n            ctx.fillStyle = '#fff';\n            ctx.fillRect(0, 0, width, height);\n        }\n        else {\n            ctx.clearRect(0, 0, width, height);\n        }\n    };\n    /** 通过 file 初始化 image 对象 */\n    Compress.prototype.getOriginImage = function () {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var url = createObjectURL(_this.file);\n            var img = new Image();\n            img.onload = function () {\n                resolve(img);\n            };\n            img.onerror = function () {\n                reject('image load error');\n            };\n            img.src = url;\n        });\n    };\n    Compress.prototype.getCanvas = function (img) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            // 通过得到图片的信息来调整显示方向以正确显示图片，主要解决 ios 系统上的图片会有旋转的问题\n            EXIF.getData(img, function () {\n                var orientation = EXIF.getTag(img, 'Orientation') || 1;\n                var _a = getTransform(img, orientation), width = _a.width, height = _a.height, matrix = _a.matrix;\n                var canvas = document.createElement('canvas');\n                var context = canvas.getContext('2d');\n                canvas.width = width;\n                canvas.height = height;\n                if (!context) {\n                    reject(new Error('context is null'));\n                    return;\n                }\n                _this.clear(context, width, height);\n                context.transform.apply(context, __spread(matrix));\n                context.drawImage(img, 0, 0);\n                resolve(canvas);\n            });\n        });\n    };\n    Compress.prototype.doScale = function (source, scale) {\n        return __awaiter(this, void 0, void 0, function () {\n            var sctx, steps, factor, mirror, mctx, width, height, originWidth, originHeight, src, context, i, dw, dh, canvas, data;\n            return __generator(this, function (_a) {\n                if (scale === 1) {\n                    return [2 /*return*/, source];\n                }\n                sctx = source.getContext('2d');\n                steps = Math.min(maxSteps, Math.ceil((1 / scale) / scaleFactor));\n                factor = Math.pow(scale, (1 / steps));\n                mirror = document.createElement('canvas');\n                mctx = mirror.getContext('2d');\n                width = source.width, height = source.height;\n                originWidth = width;\n                originHeight = height;\n                mirror.width = width;\n                mirror.height = height;\n                if (!mctx || !sctx) {\n                    throw new Error(\"mctx or sctx can't be null\");\n                }\n                for (i = 0; i < steps; i++) {\n                    dw = width * factor | 0 // eslint-disable-line no-bitwise\n                    ;\n                    dh = height * factor | 0 // eslint-disable-line no-bitwise\n                    ;\n                    // 到最后一步的时候 dw, dh 用目标缩放尺寸，否则会出现最后尺寸偏小的情况\n                    if (i === steps - 1) {\n                        dw = originWidth * scale;\n                        dh = originHeight * scale;\n                    }\n                    if (i % 2 === 0) {\n                        src = source;\n                        context = mctx;\n                    }\n                    else {\n                        src = mirror;\n                        context = sctx;\n                    }\n                    // 每次画前都清空，避免图像重叠\n                    this.clear(context, width, height);\n                    context.drawImage(src, 0, 0, width, height, 0, 0, dw, dh);\n                    width = dw;\n                    height = dh;\n                }\n                canvas = src === source ? mirror : source;\n                data = context.getImageData(0, 0, width, height);\n                // resize\n                canvas.width = width;\n                canvas.height = height;\n                // store image data\n                context.putImageData(data, 0, 0);\n                return [2 /*return*/, canvas];\n            });\n        });\n    };\n    /** 这里把 base64 字符串转为 blob 对象 */\n    Compress.prototype.toBlob = function (result) {\n        var dataURL = result.toDataURL(this.outputType, this.config.quality);\n        var buffer = atob(dataURL.split(',')[1]).split('').map(function (char) { return char.charCodeAt(0); });\n        var blob = new Blob([new Uint8Array(buffer)], { type: this.outputType });\n        return blob;\n    };\n    return Compress;\n}());\nvar compressImage = function (file, options) { return new Compress(file, options).process(); };\nexport default compressImage;\n//# sourceMappingURL=compress.js.map","import StatisticsLogger from './statisticsLog';\nimport createUploadManager from './upload';\nimport { Observable } from './observable';\nimport compressImage from './compress';\nvar statisticsLogger = new StatisticsLogger();\n/**\n * @param file 上传文件\n * @param key 目标文件名\n * @param token 上传凭证\n * @param putExtra 上传文件的相关资源信息配置\n * @param config 上传任务的配置\n * @returns 返回用于上传任务的可观察对象\n */\nfunction upload(file, key, token, putExtra, config) {\n    var options = {\n        file: file,\n        key: key,\n        token: token,\n        putExtra: putExtra,\n        config: config\n    };\n    return new Observable(function (observer) {\n        var manager = createUploadManager(options, {\n            onData: function (data) { return observer.next(data); },\n            onError: function (err) { return observer.error(err); },\n            onComplete: function (res) { return observer.complete(res); }\n        }, statisticsLogger);\n        manager.putFile();\n        return manager.stop.bind(manager);\n    });\n}\nexport { getHeadersForMkFile, getHeadersForChunkUpload } from './utils';\nexport { urlSafeBase64Encode, urlSafeBase64Decode } from './base64';\nexport { deleteUploadedChunks, getUploadUrl } from './api';\nexport { imageMogr2, watermark, imageInfo, exif, pipeline } from './image';\nexport { region } from './config';\nexport { upload, compressImage };\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}