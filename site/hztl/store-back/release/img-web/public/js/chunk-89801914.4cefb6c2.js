(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89801914"],{"075b":function(e,t,s){"use strict";s("6c48")},1148:function(e,t,s){"use strict";var a=s("a691"),n=s("1d80");e.exports="".repeat||function(e){var t=String(n(this)),s="",i=a(e);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(s+=t);return s}},3279:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"goods_search "},[s("span",[e._v("关键字：")]),s("el-input",{staticStyle:{width:"50%","margin-right":"10px"},attrs:{placeholder:e.placeholder,size:"small",clearable:""},model:{value:e.keyWords,callback:function(t){e.keyWords=t},expression:"keyWords"}}),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.searchFn}},[e._v("查询")]),s("el-button",{attrs:{size:"small"},on:{click:e.resetFn}},[e._v("重置")]),s("el-button",{attrs:{size:"small"},on:{click:e.moreSeacrhFn}},[e._v("更多筛选 "),s("i",{class:e.moreSeacrhClass})])],1)},n=[],i={name:"goodsSearch",data:function(){return{keyWords:"",moreSeacrh:!1,moreSeacrhClass:"el-icon-arrow-down"}},props:{placeholder:String},methods:{searchFn:function(){this.$emit("onSearchFn",this.keyWords)},resetFn:function(){this.keyWords="",this.$emit("onResetFn",!0)},moreSeacrhFn:function(){this.moreSeacrh=!this.moreSeacrh,this.moreSeacrhClass=this.moreSeacrh?"el-icon-arrow-up":"el-icon-arrow-down",this.$emit("onMoreSeacrh",this.moreSeacrh)}}},l=i,r=s("2877"),o=Object(r["a"])(l,a,n,!1,null,"470c10b0",null);t["a"]=o.exports},"408a":function(e,t,s){var a=s("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=a(e))throw TypeError("Incorrect invocation");return+e}},"6c48":function(e,t,s){},"83bf":function(e,t,s){"use strict";s("9fff")},"885d":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"customer_query"},[s("div",{staticClass:"search"},[s("Search",{staticStyle:{width:"652px"},attrs:{placeholder:e.placeholder},on:{onSearchFn:e.searchFn,onResetFn:e.resetFn,onMoreSeacrh:e.moreSeacrhFn}}),s("el-button",{attrs:{size:"small",type:"primary",disabled:!e.tableData.length},on:{click:e.exportExcel}},[e._v("导出Excel")])],1),e.moreSearch?s("el-row",{staticClass:"more_search_box"},[s("el-col",{staticClass:"search_item_4"},[s("div",{staticClass:"search_item"},[s("span",{staticClass:"label"},[e._v("归属员工")]),s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",filterable:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.searchObj.businessManId,callback:function(t){e.$set(e.searchObj,"businessManId",t)},expression:"searchObj.businessManId"}},e._l(e.businessManList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.userId?e.userName+"-"+e.userPhone:e.userName,value:e.userId}})})),1)],1)]),s("el-col",{staticClass:"search_item_4"},[s("div",{staticClass:"search_item"},[s("span",{staticClass:"label"},[e._v("加入日期")]),s("el-date-picker",{staticClass:"search_item_cont",attrs:{type:"daterange","unlink-panels":"","range-separator":"至",size:"small","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00"]},on:{change:e.changeTime},model:{value:e.applyTime,callback:function(t){e.applyTime=t},expression:"applyTime"}})],1)]),s("el-col",{staticClass:"search_item_4"},[s("div",{staticClass:"search_item"},[s("span",{staticClass:"label"},[e._v("所在地区")]),s("SelectArea",{staticStyle:{width:"204px"},attrs:{areaData:e.searchObj.areaIds},on:{change:e.areaChange}})],1)]),s("el-col",{staticClass:"search_item_4"},[s("div",{staticClass:"search_item"},[s("span",{staticClass:"label"},[e._v("客户类型")]),s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",placeholder:"请选择"},model:{value:e.searchObj.customerType,callback:function(t){e.$set(e.searchObj,"customerType",t)},expression:"searchObj.customerType"}},e._l(e.customerTypeList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1)]),s("el-col",{staticClass:"search_item_4"},[s("div",{staticClass:"search_item"},[s("span",{staticClass:"label"},[e._v("客户标签")]),s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",multiple:"",filterable:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.labelIds,callback:function(t){e.labelIds=t},expression:"labelIds"}},e._l(e.labelList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)]),s("el-col",{staticClass:"search_item_4"},[s("div",{staticClass:"search_item"},[s("span",{staticClass:"label"},[e._v("会员等级")]),s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",filterable:"",placeholder:"请选择"},model:{value:e.searchObj.memberGradeId,callback:function(t){e.$set(e.searchObj,"memberGradeId",t)},expression:"searchObj.memberGradeId"}},e._l(e.memberGradeList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)])],1):e._e(),s("el-table",{ref:"multipleTable",staticClass:"xtable",attrs:{size:"small",data:e.tableData,border:"",stripe:"","tooltip-effect":"dark",height:"400px"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{fixed:"",type:"selection",align:"center",width:"55"}}),s("el-table-column",{attrs:{prop:"CustomerName",label:"客户名称",align:"center","show-overflow-tooltip":"",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"ellipsis"},[e._v(e._s(e.renderAppyer(t.row)))]),s("p",{style:{color:t.row.memberGradeColor}},[e._v(e._s(t.row.memberGradeName))])]}}])}),s("el-table-column",{attrs:{prop:"phone",label:"客户电话",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(0==t.row.customerType?t.row.phone:t.row.contactsPhone)+" ")]}}])}),s("el-table-column",{attrs:{prop:"areaName",label:"所在地区",align:"center","show-overflow-tooltip":"",width:"220"}}),s("el-table-column",{attrs:{prop:"businessMan",label:"归属员工",align:"center",width:"220"}}),s("el-table-column",{attrs:{prop:"typeName",label:"客户类型",align:"center",width:"120"}}),s("el-table-column",{attrs:{prop:"customerStatus",label:"客户状态",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(" "+e._s(0==t.row.customerStatus?"待审核":1==t.row.customerStatus?"正常":"停用")+" ")])]}}])}),s("el-table-column",{attrs:{align:"center",label:"加入日期",prop:"createdAt",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.createdAt.split(".")[0].split("T").join(" ")))])]}}])}),s("el-table-column",{attrs:{prop:"labelNames",label:"客户标签",align:"center","min-width":"199","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.labelNames?t.row.labelNames.join("、"):""))])]}}])}),s("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return e.lookDetail(t.row)}}},[e._v("查看资料")]),s("el-dropdown",{staticStyle:{"margin-left":"8px",cursor:"pointer"},attrs:{trigger:"click"},on:{command:function(s){e.handleCommand(s,t.row)}}},[s("span",{staticClass:"el-dropdown-link"},[e._v(" 更多"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"basicSet"}},[e._v("基础设置")]),s("el-dropdown-item",{attrs:{command:"searchSet"}},[e._v("查件设置")]),s("el-dropdown-item",{attrs:{command:"memberGrade"}},[e._v("会员等级")]),s("el-dropdown-item",{attrs:{command:"addLabel"}},[e._v("客户标签")]),s("el-dropdown-item",{attrs:{command:"openCard"}},[e._v("开卡")]),s("el-dropdown-item",{attrs:{command:"delete"}},[e._v("删除")])],1)],1)]}}])})],1),s("div",{staticClass:"page_footer"},[s("div",[s("el-checkbox",{on:{change:e.selectAllFn},model:{value:e.checkedAll,callback:function(t){e.checkedAll=t},expression:"checkedAll"}},[e._v("全选当前查询结果")]),s("span",{staticStyle:{margin:"0px 6px",padding:"0px 6px","border-left":"1px solid #000","border-right":"1px solid #000"}},[e._v(" 已选中 "+e._s(e.selectLen)+" 条 ")]),s("span",[e._v("批量操作")]),s("el-button",{staticStyle:{"margin-left":"5px"},attrs:{plain:"",size:"small",type:"primary",disabled:e.btnDisabled},on:{click:e.allBaseSetFn}},[e._v("基础设置")]),s("el-button",{staticStyle:{"margin-left":"5px"},attrs:{plain:"",size:"small",type:"primary",disabled:e.btnDisabled},on:{click:e.allVipGradeFn}},[e._v("会员等级")]),s("el-button",{staticStyle:{"margin-left":"5px"},attrs:{plain:"",size:"small",type:"primary",disabled:e.btnDisabled},on:{click:e.allAddLabelFn}},[e._v("加标签")]),s("el-button",{staticStyle:{"margin-left":"5px"},attrs:{plain:"",size:"small",type:"danger",disabled:e.btnDisabled},on:{click:e.allDeleteFn}},[e._v("删除")])],1),s("el-pagination",{attrs:{"current-page":e.pageInfo.page,"page-sizes":[10,20,50,100],"page-size":e.pageInfo.pageSize,layout:"total, prev, pager, next, jumper, sizes",total:e.pageInfo.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),s("BasicSetDialog",{ref:"basicSet",attrs:{selectData:e.selData,searchAll:e.checkedAll,searchCond:e.searchObj},on:{onRefresh:e.refreshFn}}),s("SetVipGrade",{ref:"VipGrade",attrs:{selectData:e.selData,searchAll:e.checkedAll,searchCond:e.searchObj},on:{onRefresh:e.refreshFn}}),s("AddLabelPop",{ref:"addlabel",attrs:{isSingle:e.isSingle,selectData:e.selData,searchAll:e.checkedAll,searchCond:e.searchObj},on:{onRefresh:e.refreshFn}})],1)},n=[],i=s("5530"),l=(s("a9e3"),s("a15b"),s("2b3d"),s("d3b7"),s("3ca3"),s("ddb0"),s("159b"),s("3279")),r=s("cf55"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:e.title,visible:e.labelVisible,"close-on-click-modal":!1,width:"400px"},on:{"update:visible":function(t){e.labelVisible=t},close:e.closedFn}},[s("div",[s("el-select",{staticStyle:{margin:"16px 0",width:"100%"},attrs:{size:"small",multiple:"",filterable:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.labelIds,callback:function(t){e.labelIds=t},expression:"labelIds"}},e._l(e.labelList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"small",type:"text"},on:{click:e.closedFn}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addLabel}},[e._v("确定")])],1)])},c=[],u=s("d4ec"),d=s("bee2"),h=s("b775"),b=function(){function e(){Object(u["a"])(this,e)}return Object(d["a"])(e,[{key:"getCustomersList",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/customers",method:"get",params:e})}},{key:"exportCustomersList",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/customers/export",method:"get",params:e,contentType:"application/json; charset=utf-8",responseType:"blob"})}},{key:"getsCustomersById",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/customers/sets/".concat(e.id),method:"get"})}},{key:"setsCustomers",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/customers/sets",method:"post",data:e})}},{key:"delCustomersApi",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/customers/delete",method:"post",data:e})}},{key:"getLabelList",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/companies/labels",method:"get",params:e})}},{key:"getErpList",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/customers/erp",method:"get",params:e})}},{key:"getMemberGradeList",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/members-grades/id-and-name",method:"get",params:e})}},{key:"getDicts",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/dicts",method:"get",params:e})}},{key:"getStaffsBycid",value:function(e){return Object(h["b"])({baseURL:h["a"].accounts,url:"/staffs/by-cid",method:"get",params:e})}}]),e}(),m=new b,p={name:"labelPopover",data:function(){return{labelVisible:!1,labelIds:[],labelList:[],title:"加标签",customerQueryObj:{},labelIdsAdd:!1}},props:{selectData:Array,isSingle:Boolean,searchAll:Boolean,searchCond:Object},watch:{selectData:function(){this.init()}},mounted:function(){this.customerQueryObj=JSON.parse(sessionStorage.getItem("customerQueryObj")),this.customerQueryObj&&this.customerQueryObj.labelList?this.labelList=this.customerQueryObj.labelList:this.getLabelList()},methods:{show:function(){this.labelVisible=!0},closedFn:function(){this.labelVisible=!1},init:function(){this.labelIds=[],1==this.selectData.length&&this.isSingle?(this.title="修改标签",this.labelIds=this.selectData[0].labelIds,this.labelIdsAdd=!1):(this.title="加标签",this.labelIdsAdd=!0)},getLabelList:function(){var e=this,t={page:1,pageSize:100};m.getLabelList(t).then((function(t){e.labelList=t.rows})).catch((function(e){console.log(e)}))},showLabel:function(){this.init()},addLabel:function(){var e=this,t={ids:[],searchAll:this.searchAll,searchCond:this.searchCond,labelIds:this.labelIds,labelIdsAdd:this.labelIdsAdd};this.selectData.forEach((function(e){t.ids.push(e.id)})),m.setsCustomers(t).then((function(t){e.labelVisible=!1,e.$message.success("标签修改成功"),e.$emit("onRefresh")}))}}},f=p,y=s("2877"),g=Object(y["a"])(f,o,c,!1,null,"ec85c512",null),v=g.exports,j=s("79eb"),O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"checkDialog"},[s("el-dialog",{attrs:{title:e.title,visible:e.showDialog,"close-on-click-modal":!1,width:"776px"},on:{"update:visible":function(t){e.showDialog=t},close:e.closedFn}},[s("div",[s("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:e.dataObj,rules:e.isSignShow?e.checkRules:null,"label-width":"100px"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"结算方式",prop:"paymentType"}},[s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.dataObj.paymentType,callback:function(t){e.$set(e.dataObj,"paymentType",t)},expression:"dataObj.paymentType"}},e._l(e.paymentTypeList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.Code}})})),1)],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"发票类型",prop:"invoiceType"}},[s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.dataObj.invoiceType,callback:function(t){e.$set(e.dataObj,"invoiceType",t)},expression:"dataObj.invoiceType"}},e._l(e.invoiceTypeList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.Code}})})),1)],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"客户状态",prop:"status"}},[s("el-radio-group",{on:{change:e.typeChange},model:{value:e.dataObj.status,callback:function(t){e.$set(e.dataObj,"status",t)},expression:"dataObj.status"}},[s("el-radio",{attrs:{label:1}},[e._v("启用")]),s("el-radio",{attrs:{label:2}},[e._v("停用")])],1)],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"订货价类型",prop:"priceType"}},[s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.dataObj.priceType,callback:function(t){e.$set(e.dataObj,"priceType",t)},expression:"dataObj.priceType"}},e._l(e.priceTypeList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.Code}})})),1)],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"折扣",prop:"discount"}},[s("el-input",{attrs:{size:"small",type:"number",placeholder:"请输入内容",step:"0",min:"0",max:"100"},on:{change:function(t){return e.InputChange(e.dataObj)}},model:{value:e.dataObj.discount,callback:function(t){e.$set(e.dataObj,"discount",t)},expression:"dataObj.discount"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")])])],1)],1),e.isSignShow?s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"关联本地客户",prop:"swCustomerId"}},[s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",filterable:"",remote:"",placeholder:"请选择","remote-method":e.remoteMethodSw},on:{change:e.swCustomerChange},model:{value:e.dataObj.swCustomerId,callback:function(t){e.$set(e.dataObj,"swCustomerId",t)},expression:"dataObj.swCustomerId"}},e._l(e.customersList,(function(e,t){return s("el-option",{key:t,attrs:{disabled:e.related,label:e.related?e.swCustomerName+"（已绑定）":e.swCustomerName,value:e.swCustomerId}})})),1)],1)],1):e._e(),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"归属员工"}},[s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",filterable:"",placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.dataObj.businessManId,callback:function(t){e.$set(e.dataObj,"businessManId",t)},expression:"dataObj.businessManId"}},e._l(e.businessManList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.userId?e.userName+"-"+e.userPhone:e.userName,value:e.userId}})})),1)],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"客户标签"}},[s("el-select",{staticClass:"search_item_cont",attrs:{size:"small",multiple:"",filterable:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.dataObj.labelIds,callback:function(t){e.$set(e.dataObj,"labelIds",t)},expression:"dataObj.labelIds"}},e._l(e.labelList,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),e.isSignShow?e._e():s("el-row",[e.piSetStr?s("div",{staticClass:"tip_txt"},[e._v(" 本次批量设置的项有："+e._s(e.piSetStr)+"，保存后会对你勾选的客户进行批量修改，请谨慎操作！ ")]):e._e()])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v("取消")]),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.onSave("ruleForm")}}},[e._v("保存")])],1)])],1)},w=[],C=(s("b680"),new b),S={name:"checkDialog",data:function(){return{title:"基础设置",showDialog:!1,dataObj:{},checkRules:{paymentType:[{required:!0,message:"请选择结算方式",trigger:"change"}],invoiceType:[{required:!0,message:"请选择发票类型",trigger:"change"}],status:[{required:!0,message:"请选择客户状态",trigger:"change"}],priceType:[{required:!0,message:"请选择订货价类型",trigger:"change"}]},paymentTypeList:[],invoiceTypeList:[],priceTypeList:[],customersList:[],businessManList:[],labelList:[],isSignShow:!0,customerQueryObj:{},piSetStr:""}},props:{selectData:Array,searchAll:Boolean,searchCond:Object},watch:{selectData:function(){this.onLoad()}},mounted:function(){this.getPaymentTypeList(),this.getInvoiceTypeList(),this.getPriceTypeList()},methods:{onLoad:function(){this.customerQueryObj=JSON.parse(sessionStorage.getItem("customerQueryObj")),this.getErpCustomersList(),this.customerQueryObj&&this.customerQueryObj.businessManList?this.businessManList=this.customerQueryObj.businessManList:this.getBusinessManList(),this.customerQueryObj&&this.customerQueryObj.labelList?this.labelList=this.customerQueryObj.labelList:this.getLabelList()},typeChange:function(){var e=[];for(var t in this.dataObj)if("labelIds"==t&&this.dataObj[t].length)e.push("【客户标签】");else if(this.dataObj[t])switch(t){case"paymentType":e.push("【结算方式】");break;case"invoiceType":e.push("【发票类型】");break;case"status":e.push("【客户状态】");break;case"priceType":e.push("【订货价类型】");break;case"discount":e.push("【折扣】");break;case"businessManId":e.push("【归属员工】");break}this.piSetStr=e.join("、")},InputChange:function(e){e.discount&&Number(e.discount||0)<0?e.discount="0":e.discount&&Number(e.discount||100)>100&&(e.discount="100"),e.discount&&(e.discount=Number(e.discount).toFixed(0)),this.typeChange(),this.$forceUpdate()},swCustomerChange:function(e){var t=this;this.customersList.forEach((function(s){s.swCustomerId&&e==s.swCustomerId&&(t.dataObj.swCustomerId=s.swCustomerId,t.dataObj.swCustomerName=s.swCustomerName)}))},remoteMethodSw:function(e){this.getErpCustomersList(e)},getPaymentTypeList:function(){var e=this,t={type:"paymentType"};C.getDicts(t).then((function(t){e.paymentTypeList=t||[]})).catch((function(e){console.log(e)}))},getInvoiceTypeList:function(){var e=this,t={type:"invoiceType"};C.getDicts(t).then((function(t){e.invoiceTypeList=t||[]})).catch((function(e){console.log(e)}))},getPriceTypeList:function(){var e=this,t={type:"priceType"};C.getDicts(t).then((function(t){e.priceTypeList=t||[]})).catch((function(e){console.log(e)}))},getErpCustomersList:function(e){var t=this,s={swCustomerName:"",page:1,pageSize:500};e&&(s.swCustomerName=e),this.customersList=[],C.getErpList(s).then((function(e){if(e&&e.rows){var s={swCustomerId:0,swCustomerName:"请选择",related:!1};t.customersList.push(s),e.rows.forEach((function(e){t.customersList.push(e)}))}})).catch((function(e){console.log(e)}))},getBusinessManList:function(){var e=this,t={companyId:this.$store.state.base.companyId};this.businessManList=[],C.getStaffsBycid(t).then((function(t){if(t){var s={userId:0,userName:"请选择",userPhone:""};e.businessManList.push(s),t.forEach((function(t){e.businessManList.push(t)})),e.customerQueryObj.businessManList=e.businessManList,sessionStorage.setItem("customerQueryObj",JSON.stringify(e.customerQueryObj))}})).catch((function(e){console.log(e)}))},getLabelList:function(){var e=this,t={page:1,pageSize:100};C.getLabelList(t).then((function(t){t&&t.rows&&(e.customerQueryObj.labelList=t.rows,sessionStorage.setItem("customerQueryObj",JSON.stringify(e.customerQueryObj)),e.labelList=t.rows)})).catch((function(e){console.log(e)}))},renderAppyer:function(e){var t=e.customerType,s="";return s+=0==t?e.applyer:e.CustomerName+"-"+e.contacts,s},init:function(){var e=this;if(1==this.selectData.length){var t=this.renderAppyer(this.selectData[0]);this.title="基础设置（".concat(t,"）"),this.isSignShow=!0;var s={id:this.selectData[0].id};C.getsCustomersById(s).then((function(t){e.dataObj={id:t.id,paymentType:t.paymentType?t.paymentType:null,invoiceType:t.invoiceType?t.invoiceType:null,status:0!=t.status?t.status:1,priceType:t.priceType?t.priceType:null,discount:t.discount?100*t.discount:null,swCustomerId:t.swCustomerId?t.swCustomerId:null,businessManId:t.businessManId?t.businessManId:null,labelIds:t.labelIds,memberGradeId:t.memberGradeId?t.memberGradeId:null}}))}else this.title="批量基础设置",this.dataObj={paymentType:null,invoiceType:null,status:null,priceType:null,discount:null,swCustomerId:null,businessManId:null,labelIds:null,memberGradeId:null},this.isSignShow=!1;console.log("selectData",this.selectData)},show:function(){var e=this;this.showDialog=!0,setTimeout((function(){e.init()}),500)},closedFn:function(){this.showDialog=!1,this.$refs.ruleForm.resetFields()},onSave:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("你有必填项未完成"),!1;var s=t.$intNumToPercentNum(t.dataObj.discount),a=Object(i["a"])(Object(i["a"])({ids:[],searchAll:t.searchAll,searchCond:t.searchCond},t.dataObj),{},{discount:isNaN(s)?null:s});for(var n in t.selectData.forEach((function(e){a.ids.push(e.id)})),a)null==a[n]&&delete a[n];C.setsCustomers(a).then((function(){t.$message.success("保存成功"),t.$emit("onRefresh"),t.closedFn()}))}))},onCancel:function(){this.closedFn()}}},L=S,I=(s("075b"),Object(y["a"])(L,O,w,!1,null,"2e8fdc86",null)),_=I.exports,k=new b,D={name:"customerQuery",components:{Search:l["a"],SelectArea:r["a"],AddLabelPop:v,SetVipGrade:j["a"],BasicSetDialog:_},data:function(){return{placeholder:"客户单位名称/联系人/电话等",moreSearch:!1,applyTime:[],businessManList:[],customerTypeList:[{label:"个人",value:0},{label:"公司-经销商",value:2},{label:"公司-汽修厂",value:3},{label:"公司-生产厂家",value:4}],labelIds:[],labelList:[],memberGradeList:[{name:"VIP1",id:"1"},{name:"VIP2",id:"2"},{name:"VIP3",id:"3"}],searchObj:{keyword:""},tableData:[],pageInfo:{page:1,totalSize:0,pageSize:20},selData:[],checkedAll:!1,selectionData:[],selectLen:0,btnDisabled:!0,customerQueryObj:{},isSingle:null}},created:function(){this.getVipGradeList(),this.customerQueryObj&&this.customerQueryObj.labelList?this.labelList=this.customerQueryObj.labelList:this.getLabelList(),this.customerQueryObj&&this.customerQueryObj.businessManList?this.businessManList=this.customerQueryObj.businessManList:this.getBusinessManList()},mounted:function(){this.$route.query.memberGradeId&&(this.searchObj.memberGradeId=Number(this.$route.query.memberGradeId)),this.$route.query.labelId&&(this.labelIds.push(Number(this.$route.query.labelId)),this.searchObj.labelIds=this.labelIds.join(",")),this.initData()},destroyed:function(){},methods:{renderAppyer:function(e){var t=e.customerType,s="";return s+=0==t?e.applyer:e.CustomerName+"-"+e.contacts,s},exportExcel:function(){var e=this,t=Object(i["a"])(Object(i["a"])({status:1},this.searchObj),this.pageInfo);k.exportCustomersList(t).then((function(t){e.$message.success("导出成功！");var s=window.URL.createObjectURL(new Blob([t])),a=document.createElement("a");a.href=s;var n="客户导出列表_".concat(e.$dayjs().format("YYYY-MM-DD"),".xls");a.setAttribute("download",n),a.click()}))},getLabelList:function(){var e=this,t={page:1,pageSize:100};k.getLabelList(t).then((function(t){e.customerQueryObj.labelList=t.rows,sessionStorage.setItem("customerQueryObj",JSON.stringify(e.customerQueryObj)),e.labelList=t.rows})).catch((function(e){console.log(e)}))},getBusinessManList:function(){var e=this,t={companyId:this.$store.state.base.companyId};this.businessManList=[],k.getStaffsBycid(t).then((function(t){if(t){var s={userId:0,userName:"请选择",userPhone:""};e.businessManList.push(s),t.forEach((function(t){e.businessManList.push(t)})),e.customerQueryObj.businessManList=e.businessManList,sessionStorage.setItem("customerQueryObj",JSON.stringify(e.customerQueryObj))}})).catch((function(e){console.log(e)}))},getVipGradeList:function(){var e=this,t={};k.getMemberGradeList(t).then((function(t){e.memberGradeList=t||[],e.customerQueryObj.memberGradeList=t||[],sessionStorage.setItem("customerQueryObj",JSON.stringify(e.customerQueryObj))})).catch((function(e){console.log(e)}))},initData:function(){var e=this;this.tableData=[];var t=Object(i["a"])({},this.searchObj),s=Object(i["a"])(Object(i["a"])(Object(i["a"])({},t),this.pageInfo),{},{status:3});k.getCustomersList(s).then((function(t){t&&(e.tableData=t.rows,e.pageInfo.totalSize=t.totalSize),e.checkedAll=!1})).catch((function(e){console.log(e)}))},searchFn:function(e){this.searchObj.keyword=e,this.searchObj.labelIds=this.labelIds.join(","),this.pageInfo.page=1,this.initData()},resetFn:function(){this.searchObj={keyword:"",areaIds:[]},this.labelIds=[],this.applyTime=[],this.initData()},moreSeacrhFn:function(e){this.moreSearch=e},changeTime:function(e){e?(this.searchObj.joinStartTime=this.$dayjs(e[0]).format("YYYY-MM-DD"),this.searchObj.joinEndTime=this.$dayjs(e[1]).format("YYYY-MM-DD")):(this.searchObj.joinStartTime="",this.searchObj.joinEndTime="")},areaChange:function(e){this.searchObj.provinceId=e.areaIds[0],this.searchObj.cityId=e.areaIds[1],this.searchObj.countyId=e.areaIds[2]},handleSelectionChange:function(e){this.selectionData=e,this.checkedAll=!1,this.selectLen=e.length,this.btnDisabled=!e.length},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.pageInfo.page=1,this.initData()},handleCurrentChange:function(e){this.pageInfo.page=e,this.initData()},handleCommand:function(e,t){if("basicSet"==e&&this.baseSetFn(t),"searchSet"==e){var s="/pollablePartsSetting?"+t.id+"-"+t.customerId+"-"+t.customerType+"-"+t.CustomerName+"-"+t.applyer+"-"+t.contacts+"-"+t.CustomerName+"-"+t.contactsPhone;this.$router.push(s)}if("memberGrade"==e&&this.VipGradeFn(t),"addLabel"==e&&this.addLabelFn(t),"openCard"==e){var a={path:"/vipCard",query:{id:t.id}};this.$router.push(a)}"delete"==e&&this.delClick(t)},selectAllFn:function(e){e?(this.selectLen=this.pageInfo.totalSize,this.btnDisabled=!1):(this.selectLen=0,this.$refs.multipleTable.clearSelection(),this.btnDisabled=!0)},delClick:function(e,t){var s=this;this.checkedAll=!1,this.$confirm("确定要删除客户【".concat(e.CustomerName,"】吗")).then((function(t){s.deleteFn(e,0)})).catch((function(e){}))},deleteFn:function(e,t){var s=this,a={};t?(a={searchAll:this.checkedAll,searchCond:this.searchObj,ids:[]},e.forEach((function(e){a.ids.push(e.id)}))):a={searchAll:this.checkedAll,searchCond:this.searchObj,ids:[e.id]},k.delCustomersApi(a).then((function(e){s.$message({message:"删除成功",type:"success"}),s.searchFn()})).catch((function(e){console.log(e||"删除失败")}))},allDeleteFn:function(){var e=this;if(!this.selectionData.length)return this.$message({message:"你还没有选择数据",type:"warning"}),!1;this.$confirm("确定要删除选中的客户吗？").then((function(t){e.deleteFn(e.selectionData,1)})).catch((function(e){console.log(e)}))},baseSetFn:function(e){this.selData=[e],this.searchAll=!1,this.$refs.basicSet.show()},allBaseSetFn:function(){this.selData=this.selectionData,this.$refs.basicSet.show()},VipGradeFn:function(e){this.selData=[e],this.searchAll=!1,this.$refs.VipGrade.show()},allVipGradeFn:function(){this.selData=this.selectionData,this.$refs.VipGrade.show()},addLabelFn:function(e){this.isSingle=!0,this.selData=[e],this.searchAll=!1,this.$refs.addlabel.show()},allAddLabelFn:function(e){console.log(e),this.isSingle=!1,this.selData=this.selectionData,this.$refs.addlabel.show()},refreshFn:function(){this.initData()},lookDetail:function(e){var t={path:"/customerInfo",query:{id:e.id,type:1}};this.$router.push(t)}}},T=D,x=(s("83bf"),Object(y["a"])(T,a,n,!1,null,"5ba288d4",null));t["default"]=x.exports},"9fff":function(e,t,s){},a15b:function(e,t,s){"use strict";var a=s("23e7"),n=s("44ad"),i=s("fc6a"),l=s("a640"),r=[].join,o=n!=Object,c=l("join",",");a({target:"Array",proto:!0,forced:o||!c},{join:function(e){return r.call(i(this),void 0===e?",":e)}})},b680:function(e,t,s){"use strict";var a=s("23e7"),n=s("a691"),i=s("408a"),l=s("1148"),r=s("d039"),o=1..toFixed,c=Math.floor,u=function(e,t,s){return 0===t?s:t%2===1?u(e,t-1,s*e):u(e*e,t/2,s)},d=function(e){var t=0,s=e;while(s>=4096)t+=12,s/=4096;while(s>=2)t+=1,s/=2;return t},h=function(e,t,s){var a=-1,n=s;while(++a<6)n+=t*e[a],e[a]=n%1e7,n=c(n/1e7)},b=function(e,t){var s=6,a=0;while(--s>=0)a+=e[s],e[s]=c(a/t),a=a%t*1e7},m=function(e){var t=6,s="";while(--t>=0)if(""!==s||0===t||0!==e[t]){var a=String(e[t]);s=""===s?a:s+l.call("0",7-a.length)+a}return s},p=o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r((function(){o.call({})}));a({target:"Number",proto:!0,forced:p},{toFixed:function(e){var t,s,a,r,o=i(this),c=n(e),p=[0,0,0,0,0,0],f="",y="0";if(c<0||c>20)throw RangeError("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(f="-",o=-o),o>1e-21)if(t=d(o*u(2,69,1))-69,s=t<0?o*u(2,-t,1):o/u(2,t,1),s*=4503599627370496,t=52-t,t>0){h(p,0,s),a=c;while(a>=7)h(p,1e7,0),a-=7;h(p,u(10,a,1),0),a=t-1;while(a>=23)b(p,1<<23),a-=23;b(p,1<<a),h(p,1,1),b(p,2),y=m(p)}else h(p,0,s),h(p,1<<-t,0),y=m(p)+l.call("0",c);return c>0?(r=y.length,y=f+(r<=c?"0."+l.call("0",c-r)+y:y.slice(0,r-c)+"."+y.slice(r-c))):y=f+y,y}})},b85c:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0");var a=s("06c5");function n(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=Object(a["a"])(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,o=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return r=e.done,e},e:function(e){o=!0,l=e},f:function(){try{r||null==s["return"]||s["return"]()}finally{if(o)throw l}}}}},cf55:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-cascader",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:e.placeholder,options:e.addressOptions},on:{change:e.handleChange},model:{value:e.areaObj.areaIds,callback:function(t){e.$set(e.areaObj,"areaIds",t)},expression:"areaObj.areaIds"}})},n=[],i=(s("b0c0"),s("d64b")),l={name:"selectArea",data:function(){return{addressOptions:[],areaObj:{areaId:0,areaIds:[],areaName:""}}},props:{placeholder:{type:[String],default:"请选择所在区域"},areaData:{type:[Array],default:function(){return[]}}},watch:{areaData:function(e){this.areaObj.areaIds=e}},created:function(){this.addressOptions=Object(i["a"])()},mounted:function(){this.areaObj.areaIds=this.areaData},methods:{handleChange:function(e){this.areaObj.areaId=e[e.length-1];var t=Object(i["b"])(e[e.length-1],this.addressOptions);this.areaObj.areaName=t.name,this.$emit("change",this.areaObj)}}},r=l,o=s("2877"),c=Object(o["a"])(r,a,n,!1,null,"a03925c2",null);t["a"]=c.exports},d64b:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return l}));var a=s("b85c"),n=(s("b0c0"),s("b775"));function i(){var e=[];return Object(n["b"])({baseURL:n["a"].accounts,url:"/areas",method:"get"}).then((function(t){var s,n=t,i=Object(a["a"])(n);try{for(i.s();!(s=i.n()).done;){var l=s.value;2==l.type&&e.push({value:l.id,label:l.name,children:[]})}}catch(w){i.e(w)}finally{i.f()}var r,o=Object(a["a"])(n);try{for(o.s();!(r=o.n()).done;){var c,u=r.value,d=Object(a["a"])(e);try{for(d.s();!(c=d.n()).done;){var h=c.value;u.parenId==h.value&&h.children.push({value:u.id,label:u.name,children:[]})}}catch(w){d.e(w)}finally{d.f()}}}catch(w){o.e(w)}finally{o.f()}var b,m=Object(a["a"])(n);try{for(m.s();!(b=m.n()).done;){var p,f=b.value,y=Object(a["a"])(e);try{for(y.s();!(p=y.n()).done;){var g,v=p.value,j=Object(a["a"])(v.children);try{for(j.s();!(g=j.n()).done;){var O=g.value;f.parenId==O.value&&O.children.push({value:f.id,label:f.name})}}catch(w){j.e(w)}finally{j.f()}}}catch(w){y.e(w)}finally{y.f()}}}catch(w){m.e(w)}finally{m.f()}})),e}function l(e,t){var s,n=Object(a["a"])(t);try{for(n.s();!(s=n.n()).done;){var i,l=s.value,r=Object(a["a"])(l.children);try{for(r.s();!(i=r.n()).done;){var o,c=i.value,u=Object(a["a"])(c.children);try{for(u.s();!(o=u.n()).done;){var d=o.value;if(e==d.value)return{position:[l.value,c.value,e],name:l.label+"/"+c.label+"/"+d.label}}}catch(h){u.e(h)}finally{u.f()}}}catch(h){r.e(h)}finally{r.f()}}}catch(h){n.e(h)}finally{n.f()}return{position:[],name:""}}}}]);
//# sourceMappingURL=chunk-89801914.4cefb6c2.js.map