!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("table",[],t):"object"==typeof exports?exports.table=t():e.table=t()}(window,(function(){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var l=t[i]={i:i,l:!1,exports:{}};return e[i].call(l.exports,l,l.exports,s),l.l=!0,l.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)s.d(i,l,function(t){return e[t]}.bind(null,l));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s(s.s=56)}({0:function(e,t,s){"use strict";function i(e,t,s,i,l,n,o,a){var r,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=s,c._compiled=!0),i&&(c.functional=!0),n&&(c._scopeId="data-v-"+n),o?(r=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),l&&l.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=r):l&&(r=a?function(){l.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:l),r)if(c.functional){c._injectStyles=r;var h=c.render;c.render=function(e,t){return r.call(t),h(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,r):[r]}return{exports:e,options:c}}s.d(t,"a",(function(){return i}))},3:function(e,t){e.exports=require("@vue/babel-helper-vue-jsx-merge-props")},4:function(e,t){e.exports=require("lodash")},5:function(e,t,s){"use strict";s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return n}));const i="思锐软件 （010）60219478/60219479",l={1:"一",2:"二",3:"三"},n={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,shiftKey:16,ctrlKey:17,altKey:18,metaKey:91}},56:function(e,t,s){"use strict";s.r(t);var i=s(3),l=s.n(i),n=s(4),o=s(9),a=s.n(o),r=s(5);const c={descending:"desc",desc:"descending",ascending:"asc",asc:"ascending",null:void 0},h=["ascending","descending"],d=[10,20,50,100];var u={name:"HtTable2",componentName:"HtTable2",props:{data:Array,disabledHotkeys:Boolean,scrollToEnd:Boolean,keyScope:{type:[String,Symbol],default:()=>Symbol("table")},rowClassName:[Function,String],border:{type:Boolean,default:!0},tableRef:{type:String,default:()=>"datatable"},selectionType:{type:String,default:()=>"single"},settingAllColumn:{type:Boolean,default:!1},indexColumn:{type:Boolean,default:()=>!0},formatIndex:{type:Function},selectable:{type:Function,default:()=>!0},selectedRows:{type:Array,default:()=>[]},loading:Boolean,singleSelection:{type:Boolean,default:!0},autofocus:Boolean,pagination:Boolean,pageSize:{type:Number,default:0},currentPage:{type:Number,default:1},total:{type:Number,default:0},columns:{type:Array,default:()=>[]},setHeight:{type:Boolean,default:!0},showTableSetting:Boolean},data:()=>({isAutoScroll:!0,nextSelectedIndex:null,curSelectedRows:null,baseSelected:null}),computed:{isMultiSelect(){return"multiple"===this.selectionType},isShowDefutSelectColumn(){return this.isMultiSelect&&!this.settingAllColumn},isShowDefutIndexColumn(){return this.indexColumn&&!this.settingAllColumn},isSingleSelect(){return"single"===this.selectionType},isSelect(){return this.isSingleSelect||this.isMultiSelect},disPalySelectedRows(){if(null!==this.curSelectedRows)return this.curSelectedRows;return this.selectedRows||[]},isAllSelected:{get(){const{data:e}=this;return this.disPalySelectedRows.length&&this.disPalySelectedRows.length===e.filter(e=>this.selectable(e)).length},set(e){const{data:t}=this;this.setCurrentSelection(e?[...t.filter(e=>this.selectable(e))]:[])}}},watch:{selectedRows(e,t){if(e!==t){if(this.isAutoScroll){if(e.length){const t=this.data.findIndex(t=>t===e[0]);t>=0&&this.scrollRow(t)}}else this.isAutoScroll=!0;this.curSelectedRows=e}},data:{handler(e,t){if(e!==t){const t=this.nextSelectedIndex;this.nextSelectedIndex=null;const s=e[t];s?this.$nextTick(()=>{this.baseSelected=s,this.setCurrentSelection([s],s),this.scrollRow(t)}):this.$nextTick(()=>{const t=this.disPalySelectedRows.filter(t=>e.includes(t));this.disPalySelectedRows.length!==t.length&&this.setCurrentSelection(t),this.data.length&&this.scrollToEnd&&this.scrollRow(this.data.length-1)})}},immediate:!0},columns(){const e=this.$refs[this.tableRef];e&&e.doLayout&&this.$nextTick(()=>{setTimeout(()=>{e.doLayout()},50)})}},mounted(){this.bindhotkeys()},destroyed(){a.a.deleteScope(this.keyScope)},methods:{bindhotkeys(){this.disabledHotkeys||(a()("*",{scope:this.keyScope},(e,t)=>{const s=e.keyCode,i=!e.shiftKey;let l=null;if(!this.loading)switch(s){case r.b.enter:this.curSelectedRows&&1===this.curSelectedRows.length&&(event.preventDefault(),this.operationEvent(this.curSelectedRows[0]));break;case r.b.del:this.curSelectedRows&&1===this.curSelectedRows.length&&(event.preventDefault(),this.deleteEvent(this.curSelectedRows[0]));break;case r.b.up:event.preventDefault(),e.ctrlKey||e.altKey||(l=this.getCurSelectedRow({isPre:!0,isSingle:i}),l&&this.handleCheckboxChange(l,!0,i));break;case r.b.down:event.preventDefault(),e.ctrlKey||e.altKey||(l=this.getCurSelectedRow({isSingle:i}),l&&this.handleCheckboxChange(l,!0,i));break;case r.b.pageup:this.goPre();break;case r.b.pagedown:this.goNext()}this.$emit("hotkeysUp",e,t)}),this.autofocus&&this.setCurScope())},tableSetting(e){!this.disabledHotkeys&&e&&e.stopPropagation(),this.$emit("table-setting")},scrollRow(e){this.$nextTick(()=>{const t=this.$refs[this.tableRef].bodyWrapper.querySelectorAll("tr")[e],{scrollTop:s,clientHeight:i}=this.$refs[this.tableRef].bodyWrapper;t.offsetTop<s?this.$refs[this.tableRef].bodyWrapper.scrollTop=t.offsetTop:t.offsetTop>s+i-t.clientHeight&&(this.$refs[this.tableRef].bodyWrapper.scrollTop=t.offsetTop-i+t.clientHeight)})},goPre(){this.currentPage>1&&(this.nextSelectedIndex=this.pageSize-1,this.pageChange(this.currentPage-1))},goNext(){this.total/this.pageSize>this.currentPage&&(this.nextSelectedIndex=0,this.pageChange(this.currentPage+1))},sortChange({prop:e,order:t}){this.$emit("sort-change",{sortField:e,sort:c[t]})},pageChange(e){this.$emit("pageChange",e)},getCurSelectedRow(e){const{data:t}=this,{isPre:s,isSingle:i}=e||{};let l,o;if(i&&this.isAllSelected&&this.disPalySelectedRows.length>1)o=s?t.length:-1;else if(s){if(o=t.findIndex(e=>this.disPalySelectedRows.includes(e)),i&&0===o)return void this.goPre()}else if(o=Object(n.findLastIndex)(t,e=>this.disPalySelectedRows.includes(e)),i&&o===t.length-1)return void this.goNext();do{s?o--:o++,l=t[o]}while(l&&(this.isGroupCol(l)||!this.selectable(l)));return l&&this.scrollRow(o),l},isGroupCol:e=>"colspan"===e.colType,handleCheckboxChange(e,t,s=!1){if(!this.isSelect)return;if(!this.singleSelection&&s)return;if(!e||!this.selectable(e))return;let i=[];i=t?s||!this.isMultiSelect?[e]:[...this.disPalySelectedRows,e]:this.disPalySelectedRows.filter(t=>t!==e),t&&!i.includes(this.baseSelected)&&(this.baseSelected=e),this.setCurrentSelection(i,e)},tableRowClassName({row:e,rowIndex:t}){let s="";return this.rowClassName&&(s=Object(n.isFunction)(this.rowClassName)?this.rowClassName({row:e,rowIndex:t}):this.rowClassName),this.baseSelected===e&&(s+=" base-selected-row"),this.disPalySelectedRows.includes(e)&&(s+=" selected-row"),s},setCurrentSelection(e,t=null){const s=this.disPalySelectedRows;s!==e&&(this.isAutoScroll=!1,this.$emit("update:selectedRows",e),this.$emit("selectChange",e,t,s),this.curSelectedRows=e)},generateIndex(e,t){return this.formatIndex?this.formatIndex(e,t):(this.currentPage-1)*this.pageSize+e+1},operationEvent(e){this.$emit("rowOperation",e)},deleteEvent(e){this.$emit("rowDelete",e)},setCurScope(){this.disabledHotkeys||(this.$emit("keyScopeChange",this.keyScope),a.a.setScope(this.keyScope))},setCurScopeBySelectionBody(e){e&&e.stopPropagation(),this.disabledHotkeys||(this.$emit("keyScopeChange",this.keyScope),a.a.setScope(this.keyScope))}},render(){const e=arguments[0],{selection:t,"pager-count":s,...i}=this.$attrs,n={data:this.data,...i};this.setHeight&&!n.height&&(n.height=this.pagination?"calc(100% - 33px)":"100%");const{"sort-change":o,"current-change":a,"size-change":r,...c}=this.$listeners,u=()=>{const{data:t}=this;return e("el-checkbox",{attrs:{disabled:t&&0===t.length,indeterminate:this.disPalySelectedRows.length>0&&!this.isAllSelected},nativeOn:{click:e=>e.stopPropagation()},model:{value:this.isAllSelected,callback:e=>{this.isAllSelected=e}}})},p=({row:t,$index:s})=>e("el-checkbox",{attrs:{disabled:!this.selectable(t,s),value:this.disPalySelectedRows.includes(t)},nativeOn:{click:this.setCurScopeBySelectionBody},on:{change:e=>this.handleCheckboxChange(t,e)}}),f=t=>t.map(({key:t,prop:s,label:i,width:n,formatter:o,render:a,renderHeader:r,classNames:c,align:d,children:g,type:S,attrs:b,listeners:y})=>(b?b.hasOwnProperty("showOverflowTooltip")||(b.showOverflowTooltip=!0):b={showOverflowTooltip:!0},b.sortable&&(b.sortOrders=h),"index"===S?e("el-table-column",l()([{attrs:{label:"序号","min-width":n,align:"center",prop:"index-number"}},{attrs:b},{},{on:y},{scopedSlots:{header:this.showTableSetting?()=>e("i",{class:(this.showTableSetting?"table-setting":"")+" el-icon-setting",on:{click:this.tableSetting}}):()=>"序号"},attrs:{formatter:(e,t,s,i)=>this.generateIndex(i,e)}}])):"multiple"===S?e("el-table-column",l()([{attrs:{"min-width":n,align:"center"}},{attrs:b},{},{on:y},{scopedSlots:{default:p,header:u}}])):e("el-table-column",l()([{key:t||s,attrs:{prop:s,label:i,"min-width":n,align:d}},{attrs:b},{},{on:y},{attrs:{"label-class-name":"number"===S||"percent"===S||c?"table-header-text-align-right":""},scopedSlots:{default:({row:t,$index:i})=>a?a(t[s],t,i):e("span",{class:c},[o?o(t[s],t,i):t[s]]),header:r||void 0}}]),[g&&g.length?f(g):null])));return e("div",{class:"ht-table",on:{click:this.setCurScope}},[e("el-table",l()([{ref:this.tableRef,attrs:{"highlight-current-row":!1,border:this.border,stripe:!0,"row-class-name":this.tableRowClassName}},{on:c},{},{attrs:n},{directives:[{name:"loading",value:this.loading}],on:{"sort-change":this.sortChange,"row-click":e=>this.handleCheckboxChange(e,!this.isMultiSelect||(this.disPalySelectedRows.length>1||!this.disPalySelectedRows.includes(e)),!0),"row-dblclick":this.operationEvent},class:`table${this.disabledHotkeys?" ignore-hotkeys":""}${this.autofocus?" autofocus":""}`}]),[this.isShowDefutIndexColumn?e("el-table-column",{attrs:{label:"序号",width:"60",align:"center",prop:"index-number","label-class-name":this.showTableSetting?"table-setting":"",formatter:(e,t,s,i)=>this.generateIndex(i,e)},scopedSlots:{header:this.showTableSetting?()=>e("i",{class:"el-icon-setting",on:{click:this.tableSetting}}):()=>"序号"}}):null,this.isShowDefutSelectColumn?e("el-table-column",{attrs:{width:"48",align:"center"},scopedSlots:{default:p,header:u}}):null,this.$slots.default,f(this.columns)]),this.pagination&&e("div",{class:"pagination"},[e("el-pagination",l()([{on:{"current-change":a,"size-change":r}},{attrs:{currentPage:this.currentPage,pageSize:this.pageSize,total:this.total,pagerCount:s}},{attrs:{"page-sizes":d,layout:"total, sizes, prev, pager, next, jumper"}}]))])])}},p=s(0),f=Object(p.a)(u,void 0,void 0,!1,null,null,null);f.options.__file="packages/table/src/table.vue";var g=f.exports;g.install=function(e){e.component(g.name,g)};t.default=g},9:function(e,t){e.exports=require("hotkeys-js")}}).default}));
//# sourceMappingURL=index.js.map